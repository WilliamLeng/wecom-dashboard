<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼å¾®æ™ºæ…§å¯¼è´­æ•°æ®ä»ªè¡¨æ¿ - WilliamLeng</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #2a1f3d 0%, #3d2c5f 50%, #2a1f3d 100%);
            color: #ffffff;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* æ°´å°èƒŒæ™¯çº¹ç† */
        .watermark-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 180px,
                    rgba(255, 255, 255, 0.015) 180px,
                    rgba(255, 255, 255, 0.015) 200px
                );
            pointer-events: none;
            z-index: 1000;
        }
        
        .watermark {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent 0,
                    transparent 200px,
                    rgba(139, 92, 246, 0.02) 200px,
                    rgba(139, 92, 246, 0.02) 300px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0,
                    transparent 200px,
                    rgba(99, 102, 241, 0.015) 200px,
                    rgba(99, 102, 241, 0.015) 300px
                );
        }
        

        
        .watermark::before {
            content: 'ä»…é™æ–¹å¤ªå†…éƒ¨ä½¿ç”¨';
            position: absolute;
            top: 48%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 42px;
            font-weight: 600;
            color: rgba(139, 92, 246, 0.25);
            white-space: nowrap;
            letter-spacing: 10px;
            text-shadow: 0 0 30px rgba(139, 92, 246, 0.35);
            user-select: none;
            z-index: 999;
        }
        
        .watermark::after {
            content: 'äº’è”ç½‘åº”ç”¨æŠ€æœ¯éƒ¨ äº§å“ç®¡ç†æ¨¡å— AIæ¢ç´¢';
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 42px;
            font-weight: 600;
            color: rgba(99, 102, 241, 0.25);
            white-space: nowrap;
            letter-spacing: 10px;
            text-shadow: 0 0 30px rgba(99, 102, 241, 0.35);
            user-select: none;
            z-index: 999;
        }
        
        @keyframes watermark-pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* è¯¦æƒ…å¼¹çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(145deg, #2a1f3d 0%, #3d2c5f 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 32px;
            max-width: 95vw;
            max-height: 95vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            width: 1200px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(135deg, #8B5CF6, #06B6D4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 28px;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: #fff;
            background: rgba(239, 68, 68, 0.2);
        }

        .detail-metrics {
            display: grid;
            gap: 20px;
            margin-bottom: 30px;
        }

        .detail-metrics.grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .detail-metrics.grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .detail-metrics.grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }

        .detail-metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .detail-metric-title {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 8px;
        }

        .detail-metric-value {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 5px;
        }

        .detail-metric-change {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .detail-metric-change.positive {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .detail-metric-change.negative {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
        }

        .detail-metric-change.neutral {
            background: rgba(139, 92, 246, 0.2);
            color: #8B5CF6;
        }

        .detail-chart-section {
            margin-top: 30px;
        }

        .detail-chart-title {
            font-size: 18px;
            font-weight: 500;
            color: #fff;
            margin-bottom: 20px;
            text-align: center;
        }

        .detail-chart-container {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
            height: 400px;
        }

        .modal-charts-grid {
            display: grid;
            gap: 20px;
            margin-top: 15px;
        }

        .modal-charts-grid.grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .modal-charts-grid.grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .modal-charts-grid.grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }

        .modal-charts-grid.grid-5 {
            grid-template-columns: repeat(3, 1fr);
        }

        .modal-charts-grid.grid-6 {
            grid-template-columns: repeat(3, 1fr);
        }

        .modal-charts-grid.grid-7 {
            grid-template-columns: repeat(3, 1fr);
        }

        .metric-chart-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 16px;
        }

        .metric-chart-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 12px;
            text-align: center;
        }

        .metric-chart-canvas {
            height: 250px;
            position: relative;
        }

        /* è¯¦æƒ…é¡µé¢å¸ƒå±€å¢å¼º */
        .detail-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            padding-bottom: 15px;
        }

        .detail-tab {
            padding: 8px 16px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .detail-tab.active {
            background: linear-gradient(135deg, #8B5CF6, #06B6D4);
            color: #fff;
            border-color: transparent;
        }

        .detail-tab:hover:not(.active) {
            background: rgba(139, 92, 246, 0.2);
            color: #fff;
        }

        .detail-content {
            display: none;
        }

        .detail-content.active {
            display: block;
        }

        .detail-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .detail-filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .detail-filter-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
        }

        .detail-filter-select {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            padding: 6px 12px;
            color: #fff;
            font-size: 13px;
            min-width: 120px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .charts-grid.three-col {
            grid-template-columns: 1fr 1fr 1fr;
        }

        .charts-grid.single-col {
            grid-template-columns: 1fr;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
        }

        .chart-card-title {
            font-size: 16px;
            font-weight: 500;
            color: #fff;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-card-canvas {
            height: 300px;
        }


        
        /* ç®€çº¦æ‰«æçº¿æ•ˆæœ */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.8), transparent);
            animation: scan 4s ease-in-out infinite;
            z-index: 1000;
        }
        
        @keyframes scan {
            0% { top: 0; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100vh; opacity: 0; }
        }
        
        .header {
            background: 
                linear-gradient(135deg, rgba(20, 14, 35, 0.98) 0%, rgba(42, 31, 61, 0.95) 25%, rgba(61, 44, 95, 0.95) 50%, rgba(42, 31, 61, 0.95) 75%, rgba(20, 14, 35, 0.98) 100%),
                radial-gradient(ellipse at 15% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 60%),
                radial-gradient(ellipse at 85% 80%, rgba(99, 102, 241, 0.12) 0%, transparent 60%),
                radial-gradient(ellipse at 50% 50%, rgba(6, 182, 212, 0.05) 0%, transparent 70%),
                conic-gradient(from 0deg at 20% 30%, transparent 0deg, rgba(139, 92, 246, 0.03) 60deg, transparent 120deg),
                conic-gradient(from 180deg at 80% 70%, transparent 0deg, rgba(99, 102, 241, 0.03) 60deg, transparent 120deg),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><pattern id="tech-grid" patternUnits="userSpaceOnUse" width="40" height="40"><circle cx="20" cy="20" r="1.5" fill="rgba(139,92,246,0.15)"/><circle cx="10" cy="10" r="0.8" fill="rgba(99,102,241,0.1)"/><circle cx="30" cy="30" r="0.8" fill="rgba(99,102,241,0.1)"/><path d="M15,15 L25,25 M25,15 L15,25" stroke="rgba(139,92,246,0.08)" stroke-width="0.5"/><rect x="18" y="18" width="4" height="4" rx="1" fill="none" stroke="rgba(6,182,212,0.1)" stroke-width="0.3"/></pattern></defs><rect width="100%" height="100%" fill="url(%23tech-grid)"/></svg>');
            backdrop-filter: blur(25px);
            padding: 32px 24px;
            border-bottom: 2px solid transparent;
            border-image: linear-gradient(90deg, rgba(139, 92, 246, 0.4), rgba(6, 182, 212, 0.3), rgba(99, 102, 241, 0.4), rgba(6, 182, 212, 0.3), rgba(139, 92, 246, 0.4)) 1;
            position: sticky;
            top: 0;
            z-index: 100;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 40%, rgba(139, 92, 246, 0.08) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(99, 102, 241, 0.06) 50%, transparent 60%),
                linear-gradient(90deg, transparent 0%, rgba(6, 182, 212, 0.03) 50%, transparent 100%);
            pointer-events: none;
            animation: header-shimmer 8s ease-in-out infinite;
        }
        
        .header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(ellipse at center, transparent 30%, rgba(139, 92, 246, 0.03) 40%, transparent 70%),
                conic-gradient(from 0deg, transparent, rgba(6, 182, 212, 0.02), transparent, rgba(99, 102, 241, 0.02), transparent);
            animation: header-rotate 20s linear infinite;
            pointer-events: none;
            z-index: 1;
        }
        
        @keyframes header-shimmer {
            0%, 100% { opacity: 0.5; transform: translateX(0); }
            50% { opacity: 1; transform: translateX(10px); }
        }
        
        @keyframes header-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .header h1 {
            text-align: center;
            font-size: 32px;
            font-weight: 600;
            background: linear-gradient(135deg, #ffffff 0%, #e0e7ff 25%, #c7d2fe 50%, #e0e7ff 75%, #ffffff 100%);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            margin-bottom: 24px;
            letter-spacing: -0.5px;
            position: relative;
            z-index: 3;
            text-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .filters {
            display: flex;
            justify-content: center;
            gap: 24px;
            flex-wrap: wrap;
            position: relative;
            z-index: 3;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .filter-label {
            font-size: 13px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        select {
            background: rgba(61, 44, 95, 0.6);
            border: 1px solid rgba(156, 163, 175, 0.3);
            color: #ffffff;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
        }
        
        select:hover {
            background: rgba(61, 44, 95, 0.8);
            border-color: rgba(156, 163, 175, 0.5);
        }
        
        select:focus {
            border-color: rgba(99, 102, 241, 0.8);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }
        
        .metric-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(139, 92, 246, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .metric-title {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
        }
        
        .metric-value {
            font-size: 36px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 8px;
            line-height: 1;
        }
        
        .metric-change {
            font-size: 14px;
            font-weight: 500;
        }
        
        .positive { 
            color: #10B981; 
        }
        
        .negative { 
            color: #EF4444; 
        }
        
        .neutral { 
            color: rgba(255, 255, 255, 0.6);
        }
        
        .chart-section {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 24px;
            text-align: center;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            height: 400px;
        }
        
        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 20px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }
        
        .feature-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.15);
        }
        
        .feature-card::after {
            content: 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ… â†’';
            position: absolute;
            bottom: 12px;
            right: 15px;
            font-size: 11px;
            color: rgba(139, 92, 246, 0.6);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .feature-card:hover::after {
            opacity: 1;
        }

        /* æ›´å¤šåŠŸèƒ½å¡ç‰‡ä¸æ˜¾ç¤ºç‚¹å‡»æç¤º */
        .feature-card[data-placeholder]::after {
            content: none;
        }
        
        .feature-card[data-placeholder] {
            cursor: default;
        }
        
        .feature-card[data-placeholder]:hover {
            transform: none;
            box-shadow: none;
        }
        
        .feature-card.growing {
            border-color: rgba(16, 185, 129, 0.4);
            background: rgba(16, 185, 129, 0.03);
        }
        
        .feature-card.declining {
            border-color: rgba(239, 68, 68, 0.4);
            background: rgba(239, 68, 68, 0.03);
        }
        
        .feature-card.stable {
            border-color: rgba(139, 92, 246, 0.4);
            background: rgba(139, 92, 246, 0.03);
        }
        
        .feature-header {
            margin-bottom: 16px;
        }
        
        .feature-title {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
        }
        


        .feature-metrics {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
            border-left: 3px solid rgba(139, 92, 246, 0.5);
        }

        .metric-label {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        .metric-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metric-value {
            font-size: 14px;
            color: #fff;
            font-weight: 600;
        }

        .metric-change {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }

        .metric-change.positive {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .metric-change.negative {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
        }

        .metric-change.neutral {
            background: rgba(139, 92, 246, 0.2);
            color: #8B5CF6;
        }
        
        .mini-chart {
            height: 80px;
            margin: 12px 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 6px;
            padding: 8px;
        }
        
        .download-section {
            text-align: center;
            margin-top: 32px;
            padding: 24px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
        }
        
        .download-section h3 {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 12px;
        }
        
        .download-btn {
            background: rgb(139, 92, 246);
            color: #ffffff;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
        }
        
        .download-btn:hover {
            background: rgb(124, 58, 237);
            transform: translateY(-1px);
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
                align-items: center;
            }
            
            .features-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- æ°´å°å±‚ -->
    <div class="watermark-bg"></div>
    <div class="watermark"></div>
    
    <div class="header">
        <h1>ğŸ  æ–¹å¤ªå¨ç”µÂ·ä¼å¾®æ™ºæ…§å¯¼è´­æ•°æ®ä¸­å¿ƒ</h1>
        <div class="filters">
            <div class="filter-group">
                <div class="filter-label">æ•°æ®å‘¨æœŸ</div>
                <select id="timeRange">
                    <option>æœ€è¿‘3ä¸ªæœˆ</option>
                    <option selected>æœ€è¿‘6ä¸ªæœˆ</option>
                    <option>æœ€è¿‘12ä¸ªæœˆ</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">ç»“æŸæœˆä»½</div>
                <select id="endMonth">
                    <option value="2024-06" selected>2024å¹´6æœˆ</option>
                    <option value="2024-05">2024å¹´5æœˆ</option>
                    <option value="2024-04">2024å¹´4æœˆ</option>
                    <option value="2024-03">2024å¹´3æœˆ</option>
                    <option value="2024-02">2024å¹´2æœˆ</option>
                    <option value="2024-01">2024å¹´1æœˆ</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">ç»„ç»‡å±‚çº§</div>
                <select id="orgLevel">
                    <option>æ•´ä½“</option>
                    <option>å¤§åŒº</option>
                    <option>åˆ†å…¬å¸</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">å¯¹æ¯”ç»´åº¦</div>
                <select id="compareType">
                    <option>ç¯æ¯”</option>
                    <option>åŒæ¯”</option>
                    <option>ç»å¯¹å€¼</option>
                </select>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- å½“å‰æ•°æ®èŒƒå›´æç¤º -->
        <div id="dataRangeInfo" style="text-align: center; margin-bottom: 20px; padding: 12px; background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 8px; color: rgba(255, 255, 255, 0.8); font-size: 14px;">
            ğŸ“… å½“å‰æ˜¾ç¤ºï¼š<span id="currentRange">æœ€è¿‘6ä¸ªæœˆ (2024å¹´1æœˆ - 2024å¹´6æœˆ)</span>
        </div>
        
        <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-title">ğŸ’¼ ä¼å¾®å¼€é€šäººæ•°</div>
                <div class="metric-value">33,824</div>
                <div class="metric-change neutral">ğŸ“Š ç¯æ¯” 0%</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">ğŸ” ä¼å¾®ç™»å½•äººæ•°</div>
                <div class="metric-value">29,247</div>
                <div class="metric-change positive">ğŸ“ˆ ç¯æ¯” +1%</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">ğŸ›ï¸ æ™ºæ…§å¯¼è´­è®¿é—®</div>
                <div class="metric-value">13,434</div>
                <div class="metric-change positive">ğŸ“ˆ ç¯æ¯” +1%</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">âš¡ æ™ºæ…§å¯¼è´­ä½¿ç”¨</div>
                <div class="metric-value">10,999</div>
                <div class="metric-change positive">ğŸ“ˆ ç¯æ¯” +8%</div>
            </div>
        </div>

        <!-- ä¸»è¶‹åŠ¿å›¾ -->
        <div class="chart-section">
            <div class="section-title">ğŸ“ˆ æ ¸å¿ƒæŒ‡æ ‡è¶‹åŠ¿åˆ†æ</div>
            <div class="charts-grid">
                <div class="chart-container">
                    <canvas id="mainTrendChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="growthChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ -->
        <div class="chart-section">
            <div class="section-title">ğŸ“Š ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="chart-container">
                    <canvas id="dailyActiveChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="monthlyActiveChart"></canvas>
                </div>
            </div>
        </div>

        <!-- åŠŸèƒ½æ¨¡å—åˆ†æ -->
        <div class="chart-section">
            <div class="section-title">ğŸ¯ åŠŸèƒ½æ¨¡å—ä½¿ç”¨æƒ…å†µ</div>
            <div class="features-section">
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ¥ å¨æˆ¿å¥åº·æ£€æµ‹</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">6,222</div>
                                <div class="metric-change positive">+41%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»ºæ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">76,320</div>
                                <div class="metric-change positive">+75%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«æ¬¡æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">27,549</div>
                                <div class="metric-change positive">+175%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ’¬ æ¬¢è¿è¯­ç®¡ç†</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">å·²è§¦å‘å¥½å‹æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">1,190,926</div>
                                <div class="metric-change positive">+86%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æ‰“å¼€æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">363,798</div>
                                <div class="metric-change positive">+38%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æ‰“å¼€ç‡</div>
                            <div class="metric-right">
                                <div class="metric-value">31%</div>
                                <div class="metric-change negative">-3%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ‘¥ æœ‹å‹åœˆç®¡ç†</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">1,796,130</div>
                                <div class="metric-change positive">+24%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">95,860</div>
                                <div class="metric-change negative">-34%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æ‰§è¡Œç‡</div>
                            <div class="metric-right">
                                <div class="metric-value">5.3%</div>
                                <div class="metric-change negative">-47%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card declining">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ›’ é€‰è´­æŒ‡å—</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">176</div>
                                <div class="metric-change negative">-7%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»º+æ›´æ–°æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">375</div>
                                <div class="metric-change negative">-14%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">320</div>
                                <div class="metric-change positive">+62%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card declining">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ¤– AIé—®ç­”</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">917</div>
                                <div class="metric-change negative">-32%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">2,591</div>
                                <div class="metric-change negative">-93%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">å¹³å‡ä½¿ç”¨æ¬¡æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">2.8</div>
                                <div class="metric-change negative">-91%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card declining">
                    <div class="feature-header">
                        <div class="feature-title">ğŸª é—¨åº—æ´»åŠ¨</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»ºæ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">10</div>
                                <div class="metric-change negative">-38%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">å®¡æ ¸é€šè¿‡æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">3</div>
                                <div class="metric-change negative">-81%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æµè§ˆé‡</div>
                            <div class="metric-right">
                                <div class="metric-value">0</div>
                                <div class="metric-change negative">-100%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ  å¨æˆ¿æ¡ˆä¾‹</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">æ€»æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">5,260</div>
                                <div class="metric-change positive">+32%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">19,889</div>
                                <div class="metric-change positive">+127%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ¯ ç”¨æˆ·æœåŠ¡å¡</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">285</div>
                                <div class="metric-change neutral">0%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">2,398</div>
                                <div class="metric-change positive">+446%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">NPSäººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">252</div>
                                <div class="metric-change positive">+196%</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">NPSè¯„åˆ†</div>
                            <div class="metric-right">
                                <div class="metric-value">9.888</div>
                                <div class="metric-change neutral">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card stable" data-placeholder="true" style="border: 2px dashed rgba(139, 92, 246, 0.4); background: rgba(139, 92, 246, 0.02);">
                    <div class="feature-header">
                        <div class="feature-title">â• æ›´å¤šåŠŸèƒ½</div>
                    </div>
                    <div style="height: 120px; margin: 12px 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.02); border-radius: 6px; padding: 16px; text-align: center;">
                        <div style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-bottom: 8px;">ğŸš€ å³å°†æ¨å‡ºæ›´å¤šæ™ºèƒ½åŠŸèƒ½</div>
                        <div style="color: rgba(255, 255, 255, 0.4); font-size: 12px;">æ–°åŠŸèƒ½æ¨¡å—å°†åœ¨æ­¤å±•ç¤º<br/>æ”¯æŒåŠŸèƒ½æ‰©å±• | æŒç»­ä¼˜åŒ–ä¸­</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸‹è½½æŠ¥è¡¨åŒºåŸŸ -->
        <div class="download-section">
            <h3>ğŸ“Š å¯¼å‡ºæ•°æ®æŠ¥è¡¨</h3>
            <p style="margin: 10px 0; opacity: 0.8;">ä¸€é”®ä¸‹è½½å®Œæ•´æ•°æ®æŠ¥è¡¨ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½çš„è¯¦ç»†ç»Ÿè®¡</p>
            <button class="download-btn" onclick="downloadReport()">ğŸ“¥ ä¸‹è½½ExcelæŠ¥è¡¨</button>
        </div>
    </div>

    <script>
        // ä¸»è¶‹åŠ¿å›¾
        const mainCtx = document.getElementById('mainTrendChart').getContext('2d');
        window.usageTrendChart = new Chart(mainCtx, {
            type: 'line',
            data: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'ä¼å¾®å¼€é€šäººæ•°',
                    data: [30990, 31734, 32913, 33672, 33824],
                    borderColor: '#06B6D4',
                    backgroundColor: 'rgba(6, 182, 212, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#06B6D4',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'ä¼å¾®ç™»å½•äººæ•°',
                    data: [20926, 22941, 27823, 29051, 29247],
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'æ™ºæ…§å¯¼è´­è®¿é—®',
                    data: [6489, 8104, 11436, 13285, 13434],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#10B981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'æ™ºæ…§å¯¼è´­ä½¿ç”¨',
                    data: [4517, 5848, 8254, 10179, 10999],
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#F59E0B',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æ ¸å¿ƒæŒ‡æ ‡æœˆåº¦è¶‹åŠ¿',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: {
                            color: '#ffffff',
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        // å¢é•¿ç‡å›¾è¡¨ - æ˜¾ç¤ºå…·ä½“æŒ‡æ ‡å¢é•¿ç‡æ’å
        const growthCtx = document.getElementById('growthChart').getContext('2d');
        window.growthChart = new Chart(growthCtx, {
            type: 'bar',
            data: {
                labels: ['ç”¨æˆ·æœåŠ¡å¡-åˆ†äº«äººæ¬¡', 'ç”¨æˆ·æœåŠ¡å¡-NPSäººæ•°', 'å¨æˆ¿å¥åº·æ£€æµ‹-åˆ†äº«æ¬¡æ•°', 'å¨æˆ¿æ¡ˆä¾‹-åˆ†äº«é‡', 'æ¬¢è¿è¯­-è§¦å‘å¥½å‹æ•°'],
                datasets: [{
                    label: 'å¢é•¿ç‡ (%)',
                    data: [446, 196, 175, 127, 86],
                    backgroundColor: [
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(6, 182, 212, 0.8)',
                        'rgba(139, 92, 246, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(236, 72, 153, 0.8)'
                    ],
                    borderColor: [
                        '#10B981',
                        '#06B6D4',
                        '#8B5CF6',
                        '#F59E0B',
                        '#EC4899'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æ ¸å¿ƒæŒ‡æ ‡å¢é•¿ç‡æ’è¡Œ',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        // æ—¥æ´»è¶‹åŠ¿å›¾
        const dailyActiveCtx = document.getElementById('dailyActiveChart').getContext('2d');
        window.dailyActiveChart = new Chart(dailyActiveCtx, {
            type: 'line',
            data: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'å…¨ä½“æ—¥æ´»',
                    data: [1075, 1572, 1965, 2637, 2904],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#10B981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'ä¸‰ç±»äººå‘˜æ—¥æ´»',
                    data: [884, 1279, 1604, 2171, 2411],
                    borderColor: '#06B6D4',
                    backgroundColor: 'rgba(6, 182, 212, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#06B6D4',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æ—¥æ´»ç”¨æˆ·æ•°è¶‹åŠ¿',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: {
                            color: '#ffffff',
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        // æœˆæ´»è¶‹åŠ¿å›¾
        const monthlyActiveCtx = document.getElementById('monthlyActiveChart').getContext('2d');
        window.monthlyActiveChart = new Chart(monthlyActiveCtx, {
            type: 'line',
            data: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'å…¨ä½“æœˆæ´»',
                    data: [6488, 8102, 11434, 13283, 13434],
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'ä¸‰ç±»äººå‘˜æœˆæ´»',
                    data: [4949, 6181, 8545, 9818, 10223],
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#F59E0B',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æœˆæ´»ç”¨æˆ·æ•°è¶‹åŠ¿',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: {
                            color: '#ffffff',
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });



        // ä¸‹è½½æŠ¥è¡¨åŠŸèƒ½
        function downloadReport() {
            alert('ğŸ“Š æ­£åœ¨ç”ŸæˆExcelæŠ¥è¡¨...\n\nåŒ…å«ä»¥ä¸‹æ•°æ®ï¼š\nâ€¢ æ ¸å¿ƒæŒ‡æ ‡æœˆåº¦è¶‹åŠ¿\nâ€¢ å„åŠŸèƒ½è¯¦ç»†ä½¿ç”¨ç»Ÿè®¡\nâ€¢ ç”¨æˆ·æ´»è·ƒåº¦åˆ†æï¼ˆæ—¥æ´»/æœˆæ´»ï¼‰\nâ€¢ å¨æˆ¿å¥åº·æ£€æµ‹å’Œæ¡ˆä¾‹æ•°æ®\nâ€¢ ç”¨æˆ·æœåŠ¡å¡å’ŒNPSè¯„åˆ†\nâ€¢ æœ‹å‹åœˆç®¡ç†å’Œæ¬¢è¿è¯­\nâ€¢ AIé—®ç­”å’Œé€‰è´­æŒ‡å—\nâ€¢ é—¨åº—æ´»åŠ¨æ•°æ®\nâ€¢ åŒæ¯”ç¯æ¯”åˆ†æ');
        }

        // ç­›é€‰å™¨äº¤äº’é€»è¾‘
        document.getElementById('timeRange').addEventListener('change', function() {
            updateDataRange();
        });
        
        document.getElementById('endMonth').addEventListener('change', function() {
            updateDataRange();
        });
        
        function updateDataRange() {
            const timeRange = document.getElementById('timeRange').value;
            const endMonth = document.getElementById('endMonth').value;
            
            // è®¡ç®—æ˜¾ç¤ºçš„æœˆä»½èŒƒå›´
            let monthsToShow = 6; // é»˜è®¤6ä¸ªæœˆ
            if (timeRange.includes('3ä¸ªæœˆ')) monthsToShow = 3;
            if (timeRange.includes('12ä¸ªæœˆ')) monthsToShow = 12;
            
            // è®¡ç®—å¼€å§‹æœˆä»½
            const endDate = new Date(endMonth + '-01');
            const startDate = new Date(endDate);
            startDate.setMonth(startDate.getMonth() - (monthsToShow - 1));
            
            // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
            const startText = `${startDate.getFullYear()}å¹´${startDate.getMonth() + 1}æœˆ`;
            const endText = `${endDate.getFullYear()}å¹´${endDate.getMonth() + 1}æœˆ`;
            
            // æ›´æ–°é¡µé¢æ˜¾ç¤º
            document.getElementById('currentRange').textContent = 
                `${timeRange} (${startText} - ${endText})`;
            
            console.log(`æ˜¾ç¤ºæ•°æ®èŒƒå›´ï¼š${timeRange}ï¼Œæˆªæ­¢åˆ°${endMonth}`);
            console.log(`å…·ä½“èŒƒå›´ï¼š${startText} - ${endText}`);
            
            // å®é™…çš„å›¾è¡¨æ›´æ–°é€»è¾‘
            updateChartsWithDateRange(timeRange, endMonth);
        }
        
        // ç®€å•çš„äº¤äº’æ•ˆæœ
        document.querySelectorAll('.feature-card').forEach(card => {
            card.addEventListener('click', function() {
                const title = this.querySelector('.feature-title').textContent;
                alert(`ğŸ“Š ${title} è¯¦ç»†æ•°æ®\n\nç‚¹å‡»åŠŸèƒ½å¡ç‰‡å¯ä»¥æŸ¥çœ‹è¯¥åŠŸèƒ½çš„è¯¦ç»†å­æŒ‡æ ‡åˆ†æï¼ŒåŒ…æ‹¬ï¼š\nâ€¢ å„é¡¹æ•°æ®çš„è¯¦ç»†è¶‹åŠ¿\nâ€¢ ç”¨æˆ·è¡Œä¸ºåˆ†æ\nâ€¢ åœ°åŒºåˆ†å¸ƒæƒ…å†µ\nâ€¢ ä¼˜åŒ–å»ºè®®`);
            });
        });
        
        // ç»„ç»‡å±‚çº§å’Œå¯¹æ¯”ç»´åº¦çš„äº¤äº’
        document.getElementById('orgLevel').addEventListener('change', function() {
            const level = this.value;
            console.log(`åˆ‡æ¢åˆ°ç»„ç»‡å±‚çº§ï¼š${level}`);
            // è¿™é‡Œå¯ä»¥æ·»åŠ ç›¸åº”çš„æ•°æ®ç­›é€‰é€»è¾‘
        });
        
        document.getElementById('compareType').addEventListener('change', function() {
            const type = this.value;
            console.log(`åˆ‡æ¢å¯¹æ¯”ç»´åº¦ï¼š${type}`);
            // è¿™é‡Œå¯ä»¥æ·»åŠ ç›¸åº”çš„å¯¹æ¯”æ•°æ®æ˜¾ç¤ºé€»è¾‘
        });
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ•°æ®èŒƒå›´æ˜¾ç¤º
        updateDataRange();

        // æ•°æ®ç­›é€‰å‡½æ•°
        function updateChartsWithDateRange(timeRange, endMonth) {
            // å®šä¹‰å®Œæ•´çš„çœŸå®æ•°æ®
            const fullData = {
                months: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                monthsMap: {
                    '2024-02': 0, '2024-03': 1, '2024-04': 2, '2024-05': 3, '2024-06': 4
                },
                coreMetrics: {
                    'ä¼å¾®å¼€é€šäººæ•°': [30990, 31734, 32913, 33672, 33824],
                    'ä¼å¾®ç™»å½•äººæ•°': [20926, 22941, 27823, 29051, 29247],
                    'ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°': [6489, 8104, 11436, 13285, 13434],
                    'ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°': [4517, 5848, 8254, 10179, 10999],
                    'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æ—¥æ´»': [1075, 1572, 1965, 2637, 2904],
                    'ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æ—¥æ´»': [884, 1279, 1604, 2171, 2411],
                    'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æœˆæ´»': [6488, 8102, 11434, 13283, 13434],
                    'ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æœˆæ´»': [4949, 6181, 8545, 9818, 10223]
                },
                modules: {
                    'å¨æˆ¿å¥åº·æ£€æµ‹': {
                        'ä½¿ç”¨äººæ•°': [1168, 1869, 2995, 4410, 6222],
                        'åˆ›å»ºæ•°é‡': [5615, 15504, 26161, 43693, 76320],
                        'åˆ†äº«æ•°é‡': [3276, 8663, 12060, 10028, 27549]
                    }
                }
            };
            
            // æ ¹æ®æ—¶é—´èŒƒå›´ç­›é€‰æ•°æ®
            const monthsToShow = parseInt(timeRange.replace('è¿‘', '').replace('ä¸ªæœˆ', ''));
            const endIndex = fullData.monthsMap[endMonth] || 4; // é»˜è®¤6æœˆ
            const startIndex = Math.max(0, endIndex - monthsToShow + 1);
            
            // è·å–ç­›é€‰åçš„æ•°æ®
            const filteredMonths = fullData.months.slice(startIndex, endIndex + 1);
            const filteredUsageData = fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°'].slice(startIndex, endIndex + 1);
            const filteredDailyActive = fullData.coreMetrics['å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æ—¥æ´»'].slice(startIndex, endIndex + 1);
            const filteredMonthlyActive = fullData.coreMetrics['å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æœˆæ´»'].slice(startIndex, endIndex + 1);
            
            // æ›´æ–°ä¸»è¦è¶‹åŠ¿å›¾è¡¨
            if (window.usageTrendChart) {
                window.usageTrendChart.data.labels = filteredMonths;
                // æ›´æ–°å¤šä¸ªæ•°æ®ç³»åˆ—
                const filteredOpenData = fullData.coreMetrics['ä¼å¾®å¼€é€šäººæ•°'].slice(startIndex, endIndex + 1);
                const filteredLoginData = fullData.coreMetrics['ä¼å¾®ç™»å½•äººæ•°'].slice(startIndex, endIndex + 1);
                const filteredVisitData = fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°'].slice(startIndex, endIndex + 1);
                
                window.usageTrendChart.data.datasets[0].data = filteredOpenData;
                window.usageTrendChart.data.datasets[1].data = filteredLoginData;
                window.usageTrendChart.data.datasets[2].data = filteredVisitData;
                window.usageTrendChart.data.datasets[3].data = filteredUsageData;
                window.usageTrendChart.update();
            }
            
            // æ›´æ–°æ—¥æ´»å›¾è¡¨
            if (window.dailyActiveChart) {
                window.dailyActiveChart.data.labels = filteredMonths;
                window.dailyActiveChart.data.datasets[0].data = filteredDailyActive;
                window.dailyActiveChart.update();
            }
            
            // æ›´æ–°æœˆæ´»å›¾è¡¨
            if (window.monthlyActiveChart) {
                window.monthlyActiveChart.data.labels = filteredMonths;
                window.monthlyActiveChart.data.datasets[0].data = filteredMonthlyActive;
                window.monthlyActiveChart.update();
            }
            
            // æ›´æ–°å¢é•¿ç‡æ’è¡Œå›¾è¡¨
            if (window.growthChart) {
                // è®¡ç®—å¢é•¿ç‡ï¼ˆç¯æ¯”ï¼‰
                const calculateGrowthRate = (data, startIdx, endIdx) => {
                    if (startIdx >= endIdx || endIdx >= data.length) return 0;
                    const current = data[endIdx];
                    const previous = data[endIdx - 1];
                    return previous > 0 ? ((current - previous) / previous * 100).toFixed(1) : 0;
                };
                
                const growthRates = [
                    { name: 'å¨æˆ¿å¥åº·æ£€æµ‹-ä½¿ç”¨äººæ•°', rate: calculateGrowthRate(fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['ä½¿ç”¨äººæ•°'], startIndex, endIndex) },
                    { name: 'å¨æˆ¿å¥åº·æ£€æµ‹-åˆ›å»ºæ•°é‡', rate: calculateGrowthRate(fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ›å»ºæ•°é‡'], startIndex, endIndex) },
                    { name: 'å¨æˆ¿å¥åº·æ£€æµ‹-åˆ†äº«æ•°é‡', rate: calculateGrowthRate(fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ†äº«æ•°é‡'], startIndex, endIndex) },
                    { name: 'ä¼å¾®æ™ºæ…§å¯¼è´­-ä½¿ç”¨äººæ•°', rate: calculateGrowthRate(fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°'], startIndex, endIndex) },
                    { name: 'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­-æ—¥æ´»', rate: calculateGrowthRate(fullData.coreMetrics['å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æ—¥æ´»'], startIndex, endIndex) }
                ].sort((a, b) => parseFloat(b.rate) - parseFloat(a.rate));
                
                window.growthChart.data.labels = growthRates.map(item => item.name);
                window.growthChart.data.datasets[0].data = growthRates.map(item => parseFloat(item.rate));
                window.growthChart.update();
            }
            
            console.log(`æ•°æ®å·²æ›´æ–°ï¼šæ˜¾ç¤º${filteredMonths.join('-')}çš„æ•°æ®`);
        }

    // è¯¦æƒ…å¼¹çª—åŠŸèƒ½
    const moduleDetails = {
        'å¨æˆ¿å¥åº·æ£€æµ‹': {
            title: 'ğŸ¥ å¨æˆ¿å¥åº·æ£€æµ‹è¯¦æƒ…',
            metrics: [
                { title: 'ä½¿ç”¨äººæ•°', value: '6,222', change: '+41%', type: 'positive' },
                { title: 'åˆ›å»ºæ•°é‡', value: '76,320', change: '+75%', type: 'positive' },
                { title: 'åˆ†äº«æ¬¡æ•°', value: '27,549', change: '+175%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'ä½¿ç”¨äººæ•°',
                        data: [1168, 1869, 2995, 4410, 6222],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ›å»ºæ•°é‡',
                        data: [5615, 15504, 26161, 43693, 76320],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«æ¬¡æ•°',
                        data: [3276, 8663, 12060, 10028, 27549],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'é€‰è´­æŒ‡å—': {
            title: 'ğŸ›’ é€‰è´­æŒ‡å—è¯¦æƒ…',
            metrics: [
                { title: 'ä½¿ç”¨äººæ•°', value: '176', change: '-7%', type: 'negative' },
                { title: 'åˆ›å»º+æ›´æ–°æ•°é‡', value: '375', change: '-14%', type: 'negative' },
                { title: 'åˆ†äº«æ•°é‡', value: '320', change: '+62%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'ä½¿ç”¨äººæ•°',
                        data: [75, 68, 149, 190, 176],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ›å»º+æ›´æ–°æ•°é‡',
                        data: [125, 261, 317, 438, 375],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«æ•°é‡',
                        data: [112, 231, 248, 198, 320],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'æœ‹å‹åœˆç®¡ç†': {
            title: 'ğŸ‘¥ æœ‹å‹åœˆç®¡ç†è¯¦æƒ…',
            metrics: [
                { title: 'åˆ›å»ºæ•°é‡', value: '195', change: '+8%', type: 'positive' },
                { title: 'åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡', value: '1,796,130', change: '+24%', type: 'positive' },
                { title: 'å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡', value: '95,860', change: '+14%', type: 'positive' },
                { title: 'å‘˜å·¥æ‰§è¡Œç‡', value: '5.3%', change: '-8%', type: 'negative' },
                { title: 'è§¦è¾¾é¡¾å®¢æ¬¡æ•°', value: '9,581,610', change: '+61%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ›å»ºæ•°é‡',
                        data: [96, 170, 123, 180, 195],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡',
                        data: [998340, 1456890, 1389120, 1448290, 1796130],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡',
                        data: [29950, 39261, 65338, 84003, 95860],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å‘˜å·¥æ‰§è¡Œç‡(%)',
                        data: [3, 2.7, 4.7, 5.8, 5.3],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'è§¦è¾¾é¡¾å®¢æ¬¡æ•°',
                        data: [4789000, 6234000, 7456000, 8912000, 9581610],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'é—¨åº—æ´»åŠ¨': {
            title: 'ğŸª é—¨åº—æ´»åŠ¨è¯¦æƒ…',
            metrics: [
                { title: 'åˆ›å»ºæ•°é‡', value: '10', change: '-38%', type: 'negative' },
                { title: 'å®¡æ ¸é€šè¿‡æ•°é‡', value: '3', change: '-73%', type: 'negative' },
                { title: 'æµè§ˆé‡', value: '0', change: '-100%', type: 'negative' },
                { title: 'è½¬å‘æ•°', value: '0', change: '-100%', type: 'negative' },
                { title: 'çº¿ç´¢æ•°', value: '1', change: '0%', type: 'neutral' },
                { title: 'è®¢å•æ•°', value: '0', change: '0%', type: 'neutral' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ›å»ºæ•°é‡',
                        data: [5, 1, 13, 16, 10],
                        borderColor: '#EF4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å®¡æ ¸é€šè¿‡æ•°é‡',
                        data: [2, 0, 6, 11, 3],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æµè§ˆé‡',
                        data: [43, 1, 21, 87, 0],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'è½¬å‘æ•°',
                        data: [12, 0, 8, 23, 0],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'çº¿ç´¢æ•°',
                        data: [3, 0, 2, 4, 1],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'è®¢å•æ•°',
                        data: [1, 0, 0, 1, 0],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'æ¬¢è¿è¯­': {
            title: 'ğŸ‘‹ æ¬¢è¿è¯­è¯¦æƒ…',
            metrics: [
                { title: 'åˆ›å»ºæ¡æ•°(ç´¯è®¡)', value: '603', change: '+18%', type: 'positive' },
                { title: 'å·²è§¦å‘å¥½å‹æ•°(ç´¯è®¡)', value: '1,190,926', change: '+86%', type: 'positive' },
                { title: 'æ‰“å¼€æ•°(ç´¯è®¡)', value: '363,798', change: '+22%', type: 'positive' },
                { title: 'æ‰“å¼€ç‡(ç´¯è®¡)', value: '31%', change: '-34%', type: 'negative' },
                { title: 'äº§ç”Ÿçº¿ç´¢æ•°(ç´¯è®¡)', value: '45,069', change: '+18%', type: 'positive' },
                { title: 'çº¿ç´¢äº§ç”Ÿç‡(ç´¯è®¡)', value: '12.39%', change: '-4%', type: 'negative' },
                { title: 'æˆäº¤çº¿ç´¢æ•°(ç´¯è®¡)', value: '2,899', change: '+15%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ›å»ºæ¡æ•°(ç´¯è®¡)',
                        data: [380, 389, 447, 513, 603],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å·²è§¦å‘å¥½å‹æ•°(ç´¯è®¡)',
                        data: [640000, 780000, 890000, 1020000, 1190926],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æ‰“å¼€æ•°(ç´¯è®¡)',
                        data: [195000, 238000, 267000, 295000, 363798],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æ‰“å¼€ç‡(%)',
                        data: [65, 65, 58, 46, 31],
                        borderColor: '#EF4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'äº§ç”Ÿçº¿ç´¢æ•°(ç´¯è®¡)',
                        data: [25000, 30000, 34500, 38200, 45069],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'çº¿ç´¢äº§ç”Ÿç‡(%)',
                        data: [12.79, 12.91, 12.94, 12.87, 12.39],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æˆäº¤çº¿ç´¢æ•°(ç´¯è®¡)',
                        data: [1890, 2123, 2398, 2520, 2899],
                        borderColor: '#14B8A6',
                        backgroundColor: 'rgba(20, 184, 166, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'å¨æˆ¿æ¡ˆä¾‹': {
            title: 'ğŸ³ å¨æˆ¿æ¡ˆä¾‹è¯¦æƒ…',
            metrics: [
                { title: 'æ€»æ•°é‡', value: '5,260', change: '+32%', type: 'positive' },
                { title: 'åˆ†äº«é‡', value: '19,889', change: '-15%', type: 'negative' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'æ€»æ•°é‡',
                        data: [3981, 3982, 3982, 3982, 5260],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«é‡',
                        data: [8790, 13376, 15193, 23377, 19889],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'AIé—®ç­”': {
            title: 'ğŸ¤– AIé—®ç­”è¯¦æƒ…',
            metrics: [
                { title: 'ä½¿ç”¨äººæ•°', value: '917', change: '-32%', type: 'negative' },
                { title: 'ä½¿ç”¨äººæ¬¡', value: '2,591', change: '-27%', type: 'negative' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'ä½¿ç”¨äººæ•°',
                        data: [76, 609, 1244, 1341, 917],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'ä½¿ç”¨äººæ¬¡',
                        data: [369, 1857, 3543, 3568, 2591],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'ç”¨æˆ·æœåŠ¡å¡': {
            title: 'ğŸ¯ ç”¨æˆ·æœåŠ¡å¡è¯¦æƒ…',
            metrics: [
                { title: 'åˆ†äº«äººæ•°', value: '285', change: '0%', type: 'neutral' },
                { title: 'åˆ†äº«äººæ¬¡', value: '2,398', change: '+446%', type: 'positive' },
                { title: 'NPSäººæ•°', value: '252', change: '+196%', type: 'positive' },
                { title: 'NPSè¯„åˆ†', value: '9.888', change: '0%', type: 'neutral' }
            ],
            chartData: {
                labels: ['4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ†äº«äººæ•°',
                        data: [85, 108, 285],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«äººæ¬¡',
                        data: [558, 439, 2398],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'NPSäººæ•°',
                        data: [98, 85, 252],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'NPSè¯„åˆ†',
                        data: [9.5, 9.7, 9.888],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        }
    };

    // ä¸ºåŠŸèƒ½å¡ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶
    function addFeatureCardClickEvents() {
        const featureCards = document.querySelectorAll('.feature-card');
        featureCards.forEach(card => {
            // è·³è¿‡å ä½ç¬¦å¡ç‰‡
            if (card.hasAttribute('data-placeholder')) {
                return;
            }
            
            card.addEventListener('click', function() {
                const titleElement = this.querySelector('.feature-title');
                if (!titleElement) return;
                
                const title = titleElement.textContent.trim();
                let moduleName = '';
                
                if (title.includes('å¨æˆ¿å¥åº·æ£€æµ‹')) moduleName = 'å¨æˆ¿å¥åº·æ£€æµ‹';
                else if (title.includes('é€‰è´­æŒ‡å—')) moduleName = 'é€‰è´­æŒ‡å—';
                else if (title.includes('æœ‹å‹åœˆ')) moduleName = 'æœ‹å‹åœˆç®¡ç†';
                else if (title.includes('é—¨åº—æ´»åŠ¨')) moduleName = 'é—¨åº—æ´»åŠ¨';
                else if (title.includes('æ¬¢è¿è¯­')) moduleName = 'æ¬¢è¿è¯­';
                else if (title.includes('å¨æˆ¿æ¡ˆä¾‹')) moduleName = 'å¨æˆ¿æ¡ˆä¾‹';
                else if (title.includes('AIé—®ç­”')) moduleName = 'AIé—®ç­”';
                else if (title.includes('ç”¨æˆ·æœåŠ¡å¡')) moduleName = 'ç”¨æˆ·æœåŠ¡å¡';
                
                if (moduleName && moduleDetails[moduleName]) {
                    showModuleDetail(moduleName);
                }
            });
        });
    }

    // æ˜¾ç¤ºæ¨¡å—è¯¦æƒ…
    function showModuleDetail(moduleName) {
        const detail = moduleDetails[moduleName];
        const modal = document.getElementById('moduleDetailModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalChartsGrid = document.getElementById('modalChartsGrid');

        // è®¾ç½®æ ‡é¢˜
        modalTitle.textContent = detail.title;

        // ç”Ÿæˆå¤šä¸ªç‹¬ç«‹å›¾è¡¨
        modalChartsGrid.innerHTML = detail.chartData.datasets.map((dataset, index) => `
            <div class="metric-chart-card">
                <div class="metric-chart-title">${dataset.label}</div>
                <div class="metric-chart-canvas">
                    <canvas id="metricChart${index}"></canvas>
                </div>
            </div>
        `).join('');

        // è®¾ç½®ç½‘æ ¼å¸ƒå±€
        const chartCount = detail.chartData.datasets.length;
        modalChartsGrid.className = `modal-charts-grid grid-${chartCount}`;

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        modal.style.display = 'flex';

        // åˆ›å»ºæ¯ä¸ªç‹¬ç«‹å›¾è¡¨
        setTimeout(() => {
            detail.chartData.datasets.forEach((dataset, index) => {
                const canvas = document.getElementById(`metricChart${index}`);
                if (canvas) {
                    createSingleMetricChart(canvas, {
                        labels: detail.chartData.labels,
                        data: dataset.data,
                        label: dataset.label,
                        borderColor: dataset.borderColor,
                        backgroundColor: dataset.backgroundColor
                    });
                }
            });
        }, 100);
    }



    // åˆ›å»ºè¯¦æƒ…å›¾è¡¨
    function createDetailChart(canvas, chartData) {
        // å¦‚æœå·²æœ‰å›¾è¡¨å®ä¾‹ï¼Œå…ˆé”€æ¯
        if (canvas.chartInstance) {
            canvas.chartInstance.destroy();
        }

        canvas.chartInstance = new Chart(canvas, {
            type: 'line',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            color: '#fff',
                            font: { size: 12 }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(139, 92, 246, 0.5)',
                        borderWidth: 1
                    }
                },
                scales: {
                    x: {
                        display: true,
                        ticks: { color: '#fff', font: { size: 11 } },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    y: {
                        display: true,
                        ticks: { 
                            color: '#fff', 
                            font: { size: 11 },
                            callback: function(value) {
                                if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
                                if (value >= 1000) return (value / 1000).toFixed(1) + 'K';
                                return value;
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                },
                elements: {
                    point: { radius: 4, hoverRadius: 6 },
                    line: { borderWidth: 2 }
                }
            }
        });
    }

    // åˆ›å»ºå•ä¸ªæŒ‡æ ‡å›¾è¡¨
    function createSingleMetricChart(canvas, metricData) {
        // å¦‚æœå·²æœ‰å›¾è¡¨å®ä¾‹ï¼Œå…ˆé”€æ¯
        if (canvas.chartInstance) {
            canvas.chartInstance.destroy();
        }

        canvas.chartInstance = new Chart(canvas, {
            type: 'line',
            data: {
                labels: metricData.labels,
                datasets: [{
                    label: metricData.label,
                    data: metricData.data,
                    borderColor: metricData.borderColor,
                    backgroundColor: metricData.backgroundColor,
                    tension: 0.4,
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    borderWidth: 3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: metricData.borderColor,
                        borderWidth: 1,
                        displayColors: false
                    }
                },
                scales: {
                    x: {
                        ticks: { 
                            color: 'rgba(255, 255, 255, 0.7)', 
                            font: { size: 11 }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    y: {
                        ticks: { 
                            color: 'rgba(255, 255, 255, 0.7)', 
                            font: { size: 11 },
                            callback: function(value) {
                                if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
                                if (value >= 1000) return (value / 1000).toFixed(1) + 'K';
                                return value;
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });
    }

    // å…³é—­æ¨¡æ€æ¡†
    function closeModal() {
        const modal = document.getElementById('moduleDetailModal');
        modal.style.display = 'none';
        
        // é”€æ¯æ‰€æœ‰å›¾è¡¨å®ä¾‹
        const modalChartsGrid = document.getElementById('modalChartsGrid');
        if (modalChartsGrid) {
            const canvases = modalChartsGrid.querySelectorAll('canvas');
            canvases.forEach(canvas => {
                if (canvas.chartInstance) {
                    canvas.chartInstance.destroy();
                    canvas.chartInstance = null;
                }
            });
        }
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ·»åŠ äº‹ä»¶ç›‘å¬
    setTimeout(() => {
        addFeatureCardClickEvents();
        
        // ä¸ºå…³é—­æŒ‰é’®æ·»åŠ äº‹ä»¶
        const closeButton = document.getElementById('closeModal');
        if (closeButton) {
            closeButton.addEventListener('click', closeModal);
        }
        
        // ç‚¹å‡»é®ç½©å±‚å…³é—­
        const modalOverlay = document.getElementById('moduleDetailModal');
        if (modalOverlay) {
            modalOverlay.addEventListener('click', function(e) {
                if (e.target === modalOverlay) {
                    closeModal();
                }
            });
        }
    }, 1000);
    </script>

<!-- è¯¦æƒ…å¼¹çª— -->
<div id="moduleDetailModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle" class="modal-title"></h2>
            <button id="closeModal" class="modal-close">&times;</button>
        </div>
        
        <!-- åˆ†é¡¹è¶‹åŠ¿å›¾è¡¨ -->
        <div class="detail-chart-section">
            <h3 class="detail-chart-title">å„é¡¹æŒ‡æ ‡è¶‹åŠ¿åˆ†æ</h3>
            <div id="modalChartsGrid" class="modal-charts-grid">
                <!-- åŠ¨æ€ç”Ÿæˆå¤šä¸ªå›¾è¡¨ -->
            </div>
        </div>
    </div>
</div>

</body>
</html>