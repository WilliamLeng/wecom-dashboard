<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼å¾®æ™ºæ…§å¯¼è´­æ•°æ®ä»ªè¡¨æ¿ - WilliamLeng</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #2a1f3d 0%, #3d2c5f 50%, #2a1f3d 100%);
            color: #ffffff;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* æ°´å°èƒŒæ™¯çº¹ç† */
        .watermark-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 180px,
                    rgba(255, 255, 255, 0.015) 180px,
                    rgba(255, 255, 255, 0.015) 200px
                );
            pointer-events: none;
            z-index: 1000;
        }
        
        .watermark {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent 0,
                    transparent 200px,
                    rgba(139, 92, 246, 0.02) 200px,
                    rgba(139, 92, 246, 0.02) 300px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0,
                    transparent 200px,
                    rgba(99, 102, 241, 0.015) 200px,
                    rgba(99, 102, 241, 0.015) 300px
                );
        }
        

        
        .watermark::before {
            content: 'ä»…é™æ–¹å¤ªå†…éƒ¨ä½¿ç”¨';
            position: absolute;
            top: 48%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 42px;
            font-weight: 600;
            color: rgba(139, 92, 246, 0.25);
            white-space: nowrap;
            letter-spacing: 10px;
            text-shadow: 0 0 30px rgba(139, 92, 246, 0.35);
            user-select: none;
            z-index: 999;
        }
        
        .watermark::after {
            content: 'äº’è”ç½‘åº”ç”¨æŠ€æœ¯éƒ¨ äº§å“ç®¡ç†æ¨¡å— AIæ¢ç´¢';
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 42px;
            font-weight: 600;
            color: rgba(99, 102, 241, 0.25);
            white-space: nowrap;
            letter-spacing: 10px;
            text-shadow: 0 0 30px rgba(99, 102, 241, 0.35);
            user-select: none;
            z-index: 999;
        }
        
        @keyframes watermark-pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* è¯¦æƒ…å¼¹çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(145deg, #2a1f3d 0%, #3d2c5f 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 32px;
            max-width: 95vw;
            max-height: 95vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            width: 1200px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(135deg, #8B5CF6, #06B6D4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 28px;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: #fff;
            background: rgba(239, 68, 68, 0.2);
        }

        .detail-metrics {
            display: grid;
            gap: 20px;
            margin-bottom: 30px;
        }

        .detail-metrics.grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .detail-metrics.grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .detail-metrics.grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }

        .detail-metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .detail-metric-title {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 8px;
        }

        .detail-metric-value {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 5px;
        }

        .detail-metric-change {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .detail-metric-change.positive {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .detail-metric-change.negative {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
        }

        .detail-metric-change.neutral {
            background: rgba(139, 92, 246, 0.2);
            color: #8B5CF6;
        }

        .detail-chart-section {
            margin-top: 30px;
        }

        .detail-chart-title {
            font-size: 18px;
            font-weight: 500;
            color: #fff;
            margin-bottom: 20px;
            text-align: center;
        }

        .detail-chart-container {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
            height: 400px;
        }

        .modal-charts-grid {
            display: grid;
            gap: 20px;
            margin-top: 15px;
        }

        .modal-charts-grid.grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .modal-charts-grid.grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .modal-charts-grid.grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }

        .modal-charts-grid.grid-5 {
            grid-template-columns: repeat(3, 1fr);
        }

        .modal-charts-grid.grid-6 {
            grid-template-columns: repeat(3, 1fr);
        }

        .modal-charts-grid.grid-7 {
            grid-template-columns: repeat(3, 1fr);
        }

        .metric-chart-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 16px;
        }

        .metric-chart-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 12px;
            text-align: center;
        }

        .metric-chart-canvas {
            height: 250px;
            position: relative;
        }

        /* è¯¦æƒ…é¡µé¢å¸ƒå±€å¢å¼º */
        .detail-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            padding-bottom: 15px;
        }

        .detail-tab {
            padding: 8px 16px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .detail-tab.active {
            background: linear-gradient(135deg, #8B5CF6, #06B6D4);
            color: #fff;
            border-color: transparent;
        }

        .detail-tab:hover:not(.active) {
            background: rgba(139, 92, 246, 0.2);
            color: #fff;
        }

        .detail-content {
            display: none;
        }

        .detail-content.active {
            display: block;
        }

        .detail-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .detail-filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .detail-filter-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
        }

        .detail-filter-select {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            padding: 6px 12px;
            color: #fff;
            font-size: 13px;
            min-width: 120px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .charts-grid.three-col {
            grid-template-columns: 1fr 1fr 1fr;
        }

        .charts-grid.single-col {
            grid-template-columns: 1fr;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
        }

        .chart-card-title {
            font-size: 16px;
            font-weight: 500;
            color: #fff;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-card-canvas {
            height: 300px;
        }


        
        /* ç®€çº¦æ‰«æçº¿æ•ˆæœ */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.8), transparent);
            animation: scan 4s ease-in-out infinite;
            z-index: 1000;
        }
        
        @keyframes scan {
            0% { top: 0; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100vh; opacity: 0; }
        }
        
        .header {
            background: 
                linear-gradient(135deg, rgba(20, 14, 35, 0.98) 0%, rgba(42, 31, 61, 0.95) 25%, rgba(61, 44, 95, 0.95) 50%, rgba(42, 31, 61, 0.95) 75%, rgba(20, 14, 35, 0.98) 100%),
                radial-gradient(ellipse at 15% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 60%),
                radial-gradient(ellipse at 85% 80%, rgba(99, 102, 241, 0.12) 0%, transparent 60%),
                radial-gradient(ellipse at 50% 50%, rgba(6, 182, 212, 0.05) 0%, transparent 70%),
                conic-gradient(from 0deg at 20% 30%, transparent 0deg, rgba(139, 92, 246, 0.03) 60deg, transparent 120deg),
                conic-gradient(from 180deg at 80% 70%, transparent 0deg, rgba(99, 102, 241, 0.03) 60deg, transparent 120deg),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><pattern id="tech-grid" patternUnits="userSpaceOnUse" width="40" height="40"><circle cx="20" cy="20" r="1.5" fill="rgba(139,92,246,0.15)"/><circle cx="10" cy="10" r="0.8" fill="rgba(99,102,241,0.1)"/><circle cx="30" cy="30" r="0.8" fill="rgba(99,102,241,0.1)"/><path d="M15,15 L25,25 M25,15 L15,25" stroke="rgba(139,92,246,0.08)" stroke-width="0.5"/><rect x="18" y="18" width="4" height="4" rx="1" fill="none" stroke="rgba(6,182,212,0.1)" stroke-width="0.3"/></pattern></defs><rect width="100%" height="100%" fill="url(%23tech-grid)"/></svg>');
            backdrop-filter: blur(25px);
            padding: 32px 24px;
            border-bottom: 2px solid transparent;
            border-image: linear-gradient(90deg, rgba(139, 92, 246, 0.4), rgba(6, 182, 212, 0.3), rgba(99, 102, 241, 0.4), rgba(6, 182, 212, 0.3), rgba(139, 92, 246, 0.4)) 1;
            position: sticky;
            top: 0;
            z-index: 100;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 40%, rgba(139, 92, 246, 0.08) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(99, 102, 241, 0.06) 50%, transparent 60%),
                linear-gradient(90deg, transparent 0%, rgba(6, 182, 212, 0.03) 50%, transparent 100%);
            pointer-events: none;
            animation: header-shimmer 8s ease-in-out infinite;
        }
        
        .header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(ellipse at center, transparent 30%, rgba(139, 92, 246, 0.03) 40%, transparent 70%),
                conic-gradient(from 0deg, transparent, rgba(6, 182, 212, 0.02), transparent, rgba(99, 102, 241, 0.02), transparent);
            animation: header-rotate 20s linear infinite;
            pointer-events: none;
            z-index: 1;
        }
        
        @keyframes header-shimmer {
            0%, 100% { opacity: 0.5; transform: translateX(0); }
            50% { opacity: 1; transform: translateX(10px); }
        }
        
        @keyframes header-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .header h1 {
            text-align: center;
            font-size: 32px;
            font-weight: 600;
            background: linear-gradient(135deg, #ffffff 0%, #e0e7ff 25%, #c7d2fe 50%, #e0e7ff 75%, #ffffff 100%);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            margin-bottom: 24px;
            letter-spacing: -0.5px;
            position: relative;
            z-index: 3;
            text-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .filters {
            display: flex;
            justify-content: center;
            gap: 24px;
            flex-wrap: wrap;
            position: relative;
            z-index: 3;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .filter-label {
            font-size: 13px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        select {
            background: rgba(61, 44, 95, 0.6);
            border: 1px solid rgba(156, 163, 175, 0.3);
            color: #ffffff;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
        }
        
        select:hover {
            background: rgba(61, 44, 95, 0.8);
            border-color: rgba(156, 163, 175, 0.5);
        }
        
        select:focus {
            border-color: rgba(99, 102, 241, 0.8);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }
        
        .metric-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(139, 92, 246, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .metric-title {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
        }
        
        .metric-value {
            font-size: 36px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 8px;
            line-height: 1;
        }
        
        .metric-change {
            font-size: 14px;
            font-weight: 500;
        }
        
        .positive { 
            color: #10B981; 
        }
        
        .negative { 
            color: #EF4444; 
        }
        
        .neutral { 
            color: rgba(255, 255, 255, 0.6);
        }
        
        .chart-section {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 24px;
            text-align: center;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            height: 400px;
        }
        
        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 20px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }
        
        .feature-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.15);
        }
        
        .feature-card::after {
            content: 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ… â†’';
            position: absolute;
            bottom: 12px;
            right: 15px;
            font-size: 11px;
            color: rgba(139, 92, 246, 0.6);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .feature-card:hover::after {
            opacity: 1;
        }

        /* æ›´å¤šåŠŸèƒ½å¡ç‰‡ä¸æ˜¾ç¤ºç‚¹å‡»æç¤º */
        .feature-card[data-placeholder]::after {
            content: none;
        }
        
        .feature-card[data-placeholder] {
            cursor: default;
        }
        
        .feature-card[data-placeholder]:hover {
            transform: none;
            box-shadow: none;
        }
        
        .feature-card.growing {
            border-color: rgba(16, 185, 129, 0.4);
            background: rgba(16, 185, 129, 0.03);
        }
        
        .feature-card.declining {
            border-color: rgba(239, 68, 68, 0.4);
            background: rgba(239, 68, 68, 0.03);
        }
        
        .feature-card.stable {
            border-color: rgba(139, 92, 246, 0.4);
            background: rgba(139, 92, 246, 0.03);
        }
        
        .feature-header {
            margin-bottom: 16px;
        }
        
        .feature-title {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
        }
        


        .feature-metrics {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 6px;
            border-left: 3px solid rgba(139, 92, 246, 0.5);
        }

        .metric-label {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        .metric-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metric-value {
            font-size: 14px;
            color: #fff;
            font-weight: 600;
        }

        .metric-change {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }

        .metric-change.positive {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .metric-change.negative {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
        }

        .metric-change.neutral {
            background: rgba(139, 92, 246, 0.2);
            color: #8B5CF6;
        }
        
        .mini-chart {
            height: 80px;
            margin: 12px 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 6px;
            padding: 8px;
        }
        
        .download-section {
            text-align: center;
            margin-top: 32px;
            padding: 24px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
        }
        
        .download-section h3 {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 12px;
        }
        
        .download-btn {
            background: rgb(139, 92, 246);
            color: #ffffff;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
        }
        
        .download-btn:hover {
            background: rgb(124, 58, 237);
            transform: translateY(-1px);
        }
        
        .query-btn {
            background: linear-gradient(135deg, #10B981, #059669);
            color: #ffffff;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            outline: none;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            margin-top: 20px;
        }
        
        .query-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }
        
        .query-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
                align-items: center;
            }
            
            .features-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- æ°´å°å±‚ -->
    <div class="watermark-bg"></div>
    <div class="watermark"></div>
    
    <div class="header">
        <h1>ğŸ  æ–¹å¤ªå¨ç”µÂ·ä¼å¾®æ™ºæ…§å¯¼è´­æ•°æ®ä¸­å¿ƒ</h1>
        <div class="filters">
            <div class="filter-group">
                <div class="filter-label">æ•°æ®å‘¨æœŸ</div>
                <select id="timeRange">
                    <option>æœ€è¿‘3ä¸ªæœˆ</option>
                    <option selected>æœ€è¿‘6ä¸ªæœˆ</option>
                    <option>æœ€è¿‘12ä¸ªæœˆ</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">ç»“æŸæœˆä»½</div>
                <select id="endMonth">
                    <option value="2025-06" selected>2025å¹´6æœˆ</option>
                    <option value="2025-05">2025å¹´5æœˆ</option>
                    <option value="2025-04">2025å¹´4æœˆ</option>
                    <option value="2025-03">2025å¹´3æœˆ</option>
                    <option value="2025-02">2025å¹´2æœˆ</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">ç»„ç»‡å±‚çº§</div>
                <select id="orgLevel">
                    <option selected>æ•´ä½“</option>
                    <option disabled style="color: #888;">å¤§åŒºï¼ˆæš‚æ— æ•°æ®ï¼‰</option>
                    <option disabled style="color: #888;">åˆ†å…¬å¸ï¼ˆæš‚æ— æ•°æ®ï¼‰</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">å¯¹æ¯”ç»´åº¦</div>
                <select id="compareType">
                    <option selected>ç¯æ¯”</option>
                    <option disabled style="color: #888;">åŒæ¯”ï¼ˆæš‚æ— æ•°æ®ï¼‰</option>
                    <option>ç»å¯¹å€¼</option>
                </select>
            </div>
            <div class="filter-group">
                <button id="queryBtn" class="query-btn">
                    ğŸ” æŸ¥è¯¢æ•°æ®
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- æ•°æ®è¯´æ˜å’ŒèŒƒå›´æç¤º -->
        <div style="margin-bottom: 20px;">
            <div style="text-align: center; margin-bottom: 12px; padding: 10px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 8px; color: rgba(255, 255, 255, 0.9); font-size: 13px;">
                ğŸ“‹ <strong>æ•°æ®è¯´æ˜</strong>ï¼š2025å¹´2-6æœˆæ•´ä½“æ•°æ®ï¼Œæ”¯æŒåŠ¨æ€ç¯æ¯”åˆ†æ | å¢é•¿ç‡æ’è¡Œæ˜¾ç¤ºé€‰æ‹©æœˆä»½æ‰€æœ‰æŒ‡æ ‡çš„ç¯æ¯”å¢é•¿ç‡æ’å | å¤§åŒº/åˆ†å…¬å¸å’ŒåŒæ¯”æ•°æ®æš‚æœªæ”¶é›†
            </div>
            <div id="dataRangeInfo" style="text-align: center; padding: 12px; background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 8px; color: rgba(255, 255, 255, 0.8); font-size: 14px;">
            ğŸ“… å½“å‰æ˜¾ç¤ºï¼š<span id="currentRange">æœ€è¿‘6ä¸ªæœˆ (2024å¹´1æœˆ - 2024å¹´6æœˆ)</span>
                <div style="font-size: 12px; margin-top: 6px; opacity: 0.7;">ğŸ’¡ ä¿®æ”¹ç­›é€‰æ¡ä»¶åï¼Œç‚¹å‡»"æŸ¥è¯¢æ•°æ®"æŒ‰é’®æ›´æ–°å›¾è¡¨</div>
            </div>
        </div>
        
        <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-title">ğŸ’¼ ä¼å¾®å¼€é€šäººæ•°</div>
                <div class="metric-value">30,990</div>
                <div class="metric-change neutral">â€”</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">ğŸ” ä¼å¾®ç™»å½•äººæ•°</div>
                <div class="metric-value">20,926</div>
                <div class="metric-change neutral">â€”</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">ğŸ›ï¸ ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°</div>
                <div class="metric-value">6,489</div>
                <div class="metric-change neutral">â€”</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">âš¡ ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°</div>
                <div class="metric-value">4,517</div>
                <div class="metric-change neutral">â€”</div>
            </div>
        </div>

        <!-- ä¸»è¶‹åŠ¿å›¾ -->
        <div class="chart-section">
            <div class="section-title">ğŸ“ˆ æ ¸å¿ƒæŒ‡æ ‡è¶‹åŠ¿åˆ†æ</div>
            <div class="charts-grid">
                <div class="chart-container">
                    <canvas id="mainTrendChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="growthChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ -->
        <div class="chart-section">
            <div class="section-title">ğŸ“Š ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="chart-container">
                    <canvas id="dailyActiveChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="monthlyActiveChart"></canvas>
                </div>
            </div>
        </div>

        <!-- åŠŸèƒ½æ¨¡å—åˆ†æ -->
        <div class="chart-section">
            <div class="section-title">ğŸ¯ åŠŸèƒ½æ¨¡å—ä½¿ç”¨æƒ…å†µ</div>
            <div class="features-section">
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ¥ å¨æˆ¿å¥åº·æ£€æµ‹</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">1,168</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»ºæ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">5,615</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«æ¬¡æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">3,276</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ’¬ æ¬¢è¿è¯­ç®¡ç†</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">å·²è§¦å‘å¥½å‹æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">369,990</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æ‰“å¼€æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">239,854</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">äº§ç”Ÿçº¿ç´¢æ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">30,686</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ‘¥ æœ‹å‹åœˆç®¡ç†</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">799,776</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»ºæ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">96</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">22,717</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ›’ é€‰è´­æŒ‡å—</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">75</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»º+æ›´æ–°æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">125</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">112</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ¤– AIé—®ç­”</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">76</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">ä½¿ç”¨äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">369</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸª é—¨åº—æ´»åŠ¨</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">åˆ›å»ºæ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">10</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">å®¡æ ¸é€šè¿‡æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">3</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">æµè§ˆé‡</div>
                            <div class="metric-right">
                                <div class="metric-value">0</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ  å¨æˆ¿æ¡ˆä¾‹</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">æ€»æ•°é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">5,260</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«é‡</div>
                            <div class="metric-right">
                                <div class="metric-value">8,790</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card growing">
                    <div class="feature-header">
                        <div class="feature-title">ğŸ¯ ç”¨æˆ·æœåŠ¡å¡</div>
                    </div>
                    <div class="feature-metrics">
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«äººæ•°</div>
                            <div class="metric-right">
                                <div class="metric-value">285</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">åˆ†äº«äººæ¬¡</div>
                            <div class="metric-right">
                                <div class="metric-value">2,398</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">NPSè¯„åˆ†</div>
                            <div class="metric-right">
                                <div class="metric-value">0</div>
                                <div class="metric-change neutral">â€”</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card stable" data-placeholder="true" style="border: 2px dashed rgba(139, 92, 246, 0.4); background: rgba(139, 92, 246, 0.02);">
                    <div class="feature-header">
                        <div class="feature-title">â• æ›´å¤šåŠŸèƒ½</div>
                    </div>
                    <div style="height: 120px; margin: 12px 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.02); border-radius: 6px; padding: 16px; text-align: center;">
                        <div style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-bottom: 8px;">ğŸš€ å³å°†æ¨å‡ºæ›´å¤šæ™ºèƒ½åŠŸèƒ½</div>
                        <div style="color: rgba(255, 255, 255, 0.4); font-size: 12px;">æ–°åŠŸèƒ½æ¨¡å—å°†åœ¨æ­¤å±•ç¤º<br/>æ”¯æŒåŠŸèƒ½æ‰©å±• | æŒç»­ä¼˜åŒ–ä¸­</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸‹è½½æŠ¥è¡¨åŒºåŸŸ -->
        <div class="download-section">
            <h3>ğŸ“Š å¯¼å‡ºæ•°æ®æŠ¥è¡¨</h3>
            <p style="margin: 10px 0; opacity: 0.8;">ä¸€é”®ä¸‹è½½å®Œæ•´æ•°æ®æŠ¥è¡¨ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½çš„è¯¦ç»†ç»Ÿè®¡</p>
            <button class="download-btn" onclick="downloadReport()">ğŸ“¥ ä¸‹è½½ExcelæŠ¥è¡¨</button>
        </div>
    </div>

    <script>
        // ä¸»è¶‹åŠ¿å›¾
        const mainCtx = document.getElementById('mainTrendChart').getContext('2d');
        window.usageTrendChart = new Chart(mainCtx, {
            type: 'line',
            data: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'ä¼å¾®å¼€é€šäººæ•°',
                    data: [30990, 31734, 32913, 33672, 33824],
                    borderColor: '#06B6D4',
                    backgroundColor: 'rgba(6, 182, 212, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#06B6D4',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'ä¼å¾®ç™»å½•äººæ•°',
                    data: [20926, 22941, 27823, 29051, 29247],
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°',
                    data: [6489, 8104, 11436, 13285, 13434],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#10B981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: 'ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°',
                    data: [4517, 5848, 8254, 10179, 10999],
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#F59E0B',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æ ¸å¿ƒæŒ‡æ ‡æœˆåº¦è¶‹åŠ¿',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: {
                            color: '#ffffff',
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        // å¢é•¿ç‡å›¾è¡¨ - æ˜¾ç¤ºå…·ä½“æŒ‡æ ‡å¢é•¿ç‡æ’å
        const growthCtx = document.getElementById('growthChart').getContext('2d');
        window.growthChart = new Chart(growthCtx, {
            type: 'bar',
            data: {
                labels: ['ç”¨æˆ·æœåŠ¡å¡-åˆ†äº«äººæ¬¡', 'ç”¨æˆ·æœåŠ¡å¡-NPSäººæ•°', 'å¨æˆ¿å¥åº·æ£€æµ‹-åˆ†äº«æ¬¡æ•°', 'å¨æˆ¿æ¡ˆä¾‹-åˆ†äº«é‡', 'æ¬¢è¿è¯­-è§¦å‘å¥½å‹æ•°'],
                datasets: [{
                    label: 'å¢é•¿ç‡ (%)',
                    data: [446, 196, 175, 127, 86],
                    backgroundColor: [
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(6, 182, 212, 0.8)',
                        'rgba(139, 92, 246, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(236, 72, 153, 0.8)'
                    ],
                    borderColor: [
                        '#10B981',
                        '#06B6D4',
                        '#8B5CF6',
                        '#F59E0B',
                        '#EC4899'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æ ¸å¿ƒæŒ‡æ ‡å¢é•¿ç‡æ’è¡Œ',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        // æ—¥æ´»è¶‹åŠ¿å›¾
        const dailyActiveCtx = document.getElementById('dailyActiveChart').getContext('2d');
        window.dailyActiveChart = new Chart(dailyActiveCtx, {
            type: 'line',
            data: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'å…¨ä½“æ—¥æ´»',
                    data: [1075, 1572, 1965, 2637, 2904],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#10B981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    spanGaps: false
                }, {
                    label: 'ä¸‰ç±»äººå‘˜æ—¥æ´»',
                    data: [884, 1279, 1604, 2171, 2411],
                    borderColor: '#06B6D4',
                    backgroundColor: 'rgba(6, 182, 212, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#06B6D4',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    spanGaps: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æ—¥æ´»ç”¨æˆ·æ•°è¶‹åŠ¿',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: {
                            color: '#ffffff',
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });

        // æœˆæ´»è¶‹åŠ¿å›¾
        const monthlyActiveCtx = document.getElementById('monthlyActiveChart').getContext('2d');
        window.monthlyActiveChart = new Chart(monthlyActiveCtx, {
            type: 'line',
            data: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [{
                    label: 'å…¨ä½“æœˆæ´»',
                    data: [6488, 8102, 11434, 13283, 13434],
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    spanGaps: false
                }, {
                    label: 'ä¸‰ç±»äººå‘˜æœˆæ´»',
                    data: [4949, 6181, 8545, 9818, 10223],
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    tension: 0.4,
                    borderWidth: 3,
                    pointBackgroundColor: '#F59E0B',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    spanGaps: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'æœˆæ´»ç”¨æˆ·æ•°è¶‹åŠ¿',
                        color: '#ffffff',
                        font: { size: 16 }
                    },
                    legend: {
                        labels: {
                            color: '#ffffff',
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });



        // ä¸‹è½½æŠ¥è¡¨åŠŸèƒ½
        function downloadReport() {
            try {
                // è·å–å½“å‰æŸ¥è¯¢çš„æ—¶é—´èŒƒå›´
                const timeRange = document.getElementById('timeRange').value;
                const endMonth = document.getElementById('endMonth').value;
                const monthsToShow = parseInt(timeRange.replace('æœ€è¿‘', '').replace('ä¸ªæœˆ', ''));
                
                // ä½¿ç”¨ä¸å›¾è¡¨ç›¸åŒçš„æ•°æ®ç”Ÿæˆé€»è¾‘
                const { displayMonths, actualDataRange } = generateExportData(endMonth, monthsToShow);
                
                // ç”ŸæˆCSVå†…å®¹
                let csvContent = '\uFEFF'; // BOMå¤´ï¼Œç¡®ä¿Excelæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡
                
                // 1. æ·»åŠ æ ‡é¢˜å’Œç­›é€‰ä¿¡æ¯
                csvContent += 'æ–¹å¤ªä¼å¾®æ•°æ®åˆ†ææŠ¥è¡¨\n';
                csvContent += `æŸ¥è¯¢æ—¶é—´èŒƒå›´ï¼š${timeRange}\n`;
                csvContent += `ç»“æŸæœˆä»½ï¼š${endMonth}\n`;
                csvContent += `å®é™…æ•°æ®èŒƒå›´ï¼š${actualDataRange}\n`;
                csvContent += `ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}\n\n`;
                
                // 2. æ ¸å¿ƒæŒ‡æ ‡æ•°æ®
                // ä½¿ç”¨é¡µé¢ä¸­å·²å®šä¹‰çš„fullDataï¼ˆåœ¨scriptåº•éƒ¨å®šä¹‰ï¼‰
                const pageFullData = window.fullData || {
                    months: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                    coreMetrics: {
                        'ä¼å¾®å¼€é€šäººæ•°': [30990, 31734, 32913, 33672, 33824],
                        'ä¼å¾®ç™»å½•äººæ•°': [20926, 22941, 27823, 29051, 29247],
                        'ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°': [6489, 8104, 11436, 13285, 13434],
                        'ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°': [4517, 5848, 8254, 10179, 10999]
                    },
                    modules: {
                        'å¨æˆ¿å¥åº·æ£€æµ‹': {
                            'ä½¿ç”¨äººæ•°': [1168, 1869, 2995, 4410, 6222],
                            'åˆ›å»ºæ•°é‡': [5615, 15504, 26161, 43693, 76320],
                            'åˆ†äº«æ•°é‡': [3276, 8663, 12060, 10028, 27549]
                        },
                        'æ¬¢è¿è¯­': {
                            'åˆ›å»ºæ¡æ•°': [380, 389, 447, 513, 603],
                            'å·²è§¦å‘å¥½å‹æ•°': [369990, 382583, 463006, 641248, 1190926],
                            'æ‰“å¼€æ•°': [239854, 250055, 270790, 297712, 363798],
                            'æ‰“å¼€ç‡': [65, 65, 58, 46, 31],
                            'äº§ç”Ÿçº¿ç´¢æ•°': [30686, 32291, 35036, 38321, 45069],
                            'æ´»è·ƒçº¿ç´¢äº§ç”Ÿç‡': [12.79, 12.91, 12.94, 12.87, 12.39],
                            'æˆäº¤çº¿ç´¢æ•°': [2157, 2220, 2335, 2517, 2899]
                        },
                        'æœ‹å‹åœˆç®¡ç†': {
                            'åˆ›å»ºæ•°é‡': [96, 170, 123, 180, 195],
                            'åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡': [799776, 1354483, 736346, 1451003, 1796130],
                            'å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡': [22717, 36858, 34739, 84353, 95860],
                            'å‘˜å·¥æ‰§è¡Œç‡': [3, 2.7, 4.7, 5.8, 5.3],
                            'è§¦è¾¾é¡¾å®¢æ¬¡æ•°': [2615312, 3980114, 2677486, 5960501, 9581610]
                        },
                        'é€‰è´­æŒ‡å—': {
                            'ä½¿ç”¨äººæ•°': [75, 68, 149, 190, 176],
                            'åˆ›å»º+æ›´æ–°æ•°é‡': [125, 261, 317, 438, 375],
                            'åˆ†äº«æ•°é‡': [112, 231, 248, 198, 320]
                        },
                        'AIé—®ç­”': {
                            'ä½¿ç”¨äººæ•°': [76, 609, 1244, 1341, 917],
                            'ä½¿ç”¨äººæ¬¡': [369, 1857, 3543, 3568, 2591]
                        },
                        'é—¨åº—æ´»åŠ¨': {
                            'åˆ›å»ºæ•°é‡': [5, 1, 13, 16, 10],
                            'å®¡æ ¸é€šè¿‡æ•°é‡': [2, 0, 6, 11, 3],
                            'æµè§ˆé‡': [43, 1, 21, 87, 0],
                            'è½¬å‘æ•°': [15, 2, 3, 9, 0],
                            'çº¿ç´¢æ•°': [2, 3, 3, 1, 1],
                            'è®¢å•æ•°': [0, 4, 0, 0, 0]
                        },
                        'å¨æˆ¿æ¡ˆä¾‹': {
                            'æ€»æ•°é‡': [3981, 3982, 3982, 3982, 5260],
                            'åˆ†äº«é‡': [8790, 13376, 15193, 23377, 19889]
                        },
                        'ç”¨æˆ·æœåŠ¡å¡': {
                            'åˆ†äº«äººæ•°': [0, 0, 85, 108, 285],
                            'åˆ†äº«äººæ¬¡': [0, 0, 558, 439, 2398],
                            'NPSäººæ•°': [0, 0, 98, 85, 252],
                            'NPSè¯„åˆ†': [0, 0, 9.783, 9.882, 9.888]
                        }
                    }
                };
                
                csvContent += 'æ ¸å¿ƒæŒ‡æ ‡æœˆåº¦è¶‹åŠ¿\n';
                csvContent += 'æœˆä»½,ä¼å¾®å¼€é€šäººæ•°,ä¼å¾®ç™»å½•äººæ•°,ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°,ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°\n';
                
                // ç”Ÿæˆæ ¸å¿ƒæŒ‡æ ‡çš„å¯¼å‡ºæ•°æ®
                for (let i = 0; i < displayMonths.length; i++) {
                    const monthLabel = displayMonths[i];
                    const dataValues = getCoreMetricValues(pageFullData, monthLabel);
                    if (dataValues.hasData) {
                        csvContent += `${monthLabel},${dataValues.values.join(',')}\n`;
                    } else {
                        csvContent += `${monthLabel},æ— æ•°æ®,æ— æ•°æ®,æ— æ•°æ®,æ— æ•°æ®\n`;
                    }
                }
                
                csvContent += '\n';
                
                csvContent += '\n';
                
                // 3. æ·»åŠ å®Œæ•´çš„åŠŸèƒ½æ¨¡å—æ•°æ®
                
                // æ·»åŠ å„ä¸ªåŠŸèƒ½æ¨¡å—çš„æ•°æ®
                Object.keys(pageFullData.modules).forEach(moduleName => {
                    csvContent += `${moduleName}\n`;
                    const moduleData = pageFullData.modules[moduleName];
                    const metricNames = Object.keys(moduleData);
                    
                    // æ·»åŠ è¡¨å¤´
                    csvContent += `æœˆä»½,${metricNames.join(',')}\n`;
                    
                    // æ·»åŠ æ•°æ®è¡Œ
                    for (let i = 0; i < displayMonths.length; i++) {
                        const monthLabel = displayMonths[i];
                        const moduleValues = getModuleValues(pageFullData, moduleName, metricNames, monthLabel);
                        csvContent += `${monthLabel},${moduleValues.values.join(',')}\n`;
                    }
                    
                    csvContent += '\n';
                });
                
                // 4. æ·»åŠ è¯´æ˜
                csvContent += 'è¯´æ˜ï¼š\n';
                csvContent += 'â€¢ ä¸Šè¿°æ•°æ®æ ¹æ®æ‚¨é€‰æ‹©çš„æ—¶é—´èŒƒå›´åŠ¨æ€ç”Ÿæˆ\n';
                csvContent += 'â€¢ ä»…2025å¹´2-6æœˆæœ‰å®é™…æ•°æ®\n';
                csvContent += 'â€¢ å…¶ä»–æœˆä»½æ˜¾ç¤º"æ— æ•°æ®"\n\n';
                
                // ç”Ÿæˆæ–‡ä»¶å
                const fileName = `æ–¹å¤ªä¼å¾®æ•°æ®æŠ¥è¡¨_${endMonth.replace('-', 'å¹´')}_${new Date().toISOString().slice(0, 10)}.csv`;
                
                // åˆ›å»ºå’Œä¸‹è½½æ–‡ä»¶
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', fileName);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // æ˜¾ç¤ºæˆåŠŸæç¤º
                    alert(`ğŸ“Š æŠ¥è¡¨ä¸‹è½½æˆåŠŸï¼\n\næ–‡ä»¶åï¼š${fileName}\n\nåŒ…å«æ•°æ®ï¼š\nâ€¢ æ ¸å¿ƒæŒ‡æ ‡æœˆåº¦è¶‹åŠ¿ï¼ˆ4é¡¹ï¼‰\nâ€¢ ç”¨æˆ·æ´»è·ƒåº¦åˆ†æï¼ˆæ—¥æ´»/æœˆæ´»ï¼‰\nâ€¢ å¨æˆ¿å¥åº·æ£€æµ‹è¯¦ç»†æ•°æ®\nâ€¢ æ¬¢è¿è¯­ç®¡ç†å®Œæ•´ç»Ÿè®¡\nâ€¢ æœ‹å‹åœˆç®¡ç†æ•°æ®\nâ€¢ é€‰è´­æŒ‡å—ä½¿ç”¨æƒ…å†µ\nâ€¢ AIé—®ç­”ç»Ÿè®¡\nâ€¢ é—¨åº—æ´»åŠ¨æ•°æ®\nâ€¢ å¨æˆ¿æ¡ˆä¾‹ç»Ÿè®¡\nâ€¢ ç”¨æˆ·æœåŠ¡å¡åŠNPSæ•°æ®\nâ€¢ ç¯æ¯”å¢é•¿ç‡åˆ†æ\n\nè¯·ç”¨Excelæ‰“å¼€æŸ¥çœ‹å®Œæ•´æŠ¥è¡¨ã€‚`);
                } else {
                    alert('æµè§ˆå™¨ä¸æ”¯æŒæ–‡ä»¶ä¸‹è½½åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ç°ä»£æµè§ˆå™¨ã€‚');
                }
                
            } catch (error) {
                console.error('ä¸‹è½½æŠ¥è¡¨æ—¶å‡ºé”™ï¼š', error);
                alert('æŠ¥è¡¨ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚');
            }
        }

        // ç”Ÿæˆå¯¼å‡ºæ•°æ®çš„æ—¶é—´èŒƒå›´ï¼ˆä¸å›¾è¡¨é€»è¾‘ä¸€è‡´ï¼‰
        function generateExportData(endMonth, monthsToShow) {
            // è§£æé€‰æ‹©çš„å¹´æœˆ
            const selectedYear = parseInt(endMonth.split('-')[0]); // 2025
            const selectedMonth = parseInt(endMonth.split('-')[1]); // 6 (6æœˆ)
            
            // ç”Ÿæˆå®Œæ•´çš„æ—¶é—´è½´
            const displayMonths = [];
            
            // ä»ç»“æŸæœˆä»½å¼€å§‹ï¼Œå¾€å‰æ¨ç®—
            for (let i = 0; i < monthsToShow; i++) {
                // è®¡ç®—è·ç¦»ç»“æŸæœˆä»½çš„åç§»é‡ï¼ˆä»æœ€æ—©çš„æœˆä»½å¼€å§‹ï¼‰
                let monthsBack = monthsToShow - 1 - i;
                
                let displayYear = selectedYear;
                let displayMonth = selectedMonth - monthsBack;
                
                // å¤„ç†æœˆä»½å°äº1çš„æƒ…å†µï¼ˆè·¨å¹´ï¼‰
                while (displayMonth <= 0) {
                    displayMonth += 12;
                    displayYear -= 1;
                }
                
                // ç”Ÿæˆæœˆä»½æ ‡ç­¾
                let monthLabel;
                if (displayYear === selectedYear) {
                    monthLabel = `${displayMonth}æœˆ`;
                } else {
                    monthLabel = `${displayMonth}æœˆ(${displayYear}å¹´)`;
                }
                
                displayMonths.push(monthLabel);
            }
            
            // è®¡ç®—å®é™…æ•°æ®èŒƒå›´æè¿°
            const firstMonth = displayMonths[0];
            const lastMonth = displayMonths[displayMonths.length - 1];
            const actualDataRange = `${firstMonth} - ${lastMonth}ï¼Œå…±${monthsToShow}ä¸ªæœˆï¼ˆä»…2025å¹´2-6æœˆæœ‰å®é™…æ•°æ®ï¼‰`;
            
            return { displayMonths, actualDataRange };
        }
        
        // è·å–æ ¸å¿ƒæŒ‡æ ‡æ•°å€¼
        function getCoreMetricValues(fullData, monthLabel) {
            // ç§»é™¤å¹´ä»½æ ‡è¯†ï¼Œåªä¿ç•™æœˆä»½
            const cleanMonth = monthLabel.replace(/\(\d+å¹´\)/, '');
            
            // æ£€æŸ¥æ˜¯å¦åœ¨æ•°æ®èŒƒå›´å†…ï¼ˆ2025å¹´2-6æœˆï¼‰
            const monthIndex = fullData.months.indexOf(cleanMonth);
            
            if (monthIndex !== -1) {
                return {
                    hasData: true,
                    values: [
                        fullData.coreMetrics['ä¼å¾®å¼€é€šäººæ•°'][monthIndex],
                        fullData.coreMetrics['ä¼å¾®ç™»å½•äººæ•°'][monthIndex],
                        fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°'][monthIndex],
                        fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°'][monthIndex]
                    ]
                };
            } else {
                return {
                    hasData: false,
                    values: []
                };
            }
        }
        
        // è·å–æ¨¡å—æ•°æ®å€¼
        function getModuleValues(fullData, moduleName, metricNames, monthLabel) {
            // ç§»é™¤å¹´ä»½æ ‡è¯†ï¼Œåªä¿ç•™æœˆä»½
            const cleanMonth = monthLabel.replace(/\(\d+å¹´\)/, '');
            
            // æ£€æŸ¥æ˜¯å¦åœ¨æ•°æ®èŒƒå›´å†…ï¼ˆ2025å¹´2-6æœˆï¼‰
            const monthIndex = fullData.months.indexOf(cleanMonth);
            
            if (monthIndex !== -1 && fullData.modules[moduleName]) {
                const values = metricNames.map(metricName => {
                    return fullData.modules[moduleName][metricName] ? 
                           fullData.modules[moduleName][metricName][monthIndex] : 'æ— æ•°æ®';
                });
                return { hasData: true, values };
            } else {
                return {
                    hasData: false,
                    values: metricNames.map(() => 'æ— æ•°æ®')
                };
            }
        }

        // ç­›é€‰å™¨äº¤äº’é€»è¾‘ï¼ˆç§»é™¤è‡ªåŠ¨æ›´æ–°ï¼‰
        document.getElementById('timeRange').addEventListener('change', function() {
            console.log('æ—¶é—´èŒƒå›´å·²æ”¹å˜ï¼Œç­‰å¾…ç”¨æˆ·ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®');
        });
        
        document.getElementById('endMonth').addEventListener('change', function() {
            console.log('ç»“æŸæœˆä»½å·²æ”¹å˜ï¼Œç­‰å¾…ç”¨æˆ·ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®');
        });
        
        // æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼ˆç®€åŒ–ç‰ˆï¼‰
        document.getElementById('queryBtn').addEventListener('click', function() {
            const button = this;
            
            // 1. ç®€å•çš„æŒ‰é’®çŠ¶æ€å˜åŒ–
            button.textContent = 'ğŸ”„ æŸ¥è¯¢ä¸­...';
            button.disabled = true;
            
            // 2. ç«‹å³æ‰§è¡Œæ•°æ®æ›´æ–°
            setTimeout(() => {
                try {
                    console.log('å¼€å§‹æ‰§è¡ŒupdateDataRange...');
            updateDataRange();
                    
                    // 3. æ¢å¤æŒ‰é’®çŠ¶æ€
                    button.textContent = 'ğŸ” æŸ¥è¯¢æ•°æ®';
                    button.disabled = false;
                    
                    // 4. æˆåŠŸæç¤º
                    button.style.background = '#10B981';
                    setTimeout(() => {
                        button.style.background = '';
                    }, 1000);
                    
                    console.log('âœ… æŸ¥è¯¢å®Œæˆ');
                    
                } catch (error) {
                    console.error('æ•°æ®æ›´æ–°å‡ºé”™ï¼š', error);
                    button.textContent = 'ğŸ” æŸ¥è¯¢æ•°æ®';
                    button.disabled = false;
                    alert(`æ•°æ®æ›´æ–°å¤±è´¥ï¼š${error.message}`);
                }
            }, 100);
        });
        
        function updateDataRange() {
            const timeRange = document.getElementById('timeRange').value;
            const endMonth = document.getElementById('endMonth').value;
            console.log(`ğŸ” updateDataRangeè¢«è°ƒç”¨: timeRange=${timeRange}, endMonth=${endMonth}`);
            
            // æ•°æ®æœˆä»½æ˜ å°„
            const monthsMap = {
                '2025-02': { index: 0, name: '2æœˆ' },
                '2025-03': { index: 1, name: '3æœˆ' },
                '2025-04': { index: 2, name: '4æœˆ' },
                '2025-05': { index: 3, name: '5æœˆ' },
                '2025-06': { index: 4, name: '6æœˆ' }
            };
            
            const availableMonths = ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'];
            
            // è®¡ç®—å›¾è¡¨æ˜¾ç¤ºèŒƒå›´ - ä»¥é€‰æ‹©æœˆä»½ä¸ºç»ˆç‚¹ï¼Œå‘å‰æ¨ç®—
            const monthsToShow = parseInt(timeRange.replace('æœ€è¿‘', '').replace('ä¸ªæœˆ', ''));
            
            // å®‰å…¨æ£€æŸ¥ï¼šç¡®ä¿endMonthå­˜åœ¨äºmonthsMapä¸­
            if (!monthsMap[endMonth]) {
                console.error(`æ— æ•ˆçš„ç»“æŸæœˆä»½: ${endMonth}`);
                alert(`æ— æ•ˆçš„æœˆä»½é€‰æ‹©: ${endMonth}`);
                return;
            }
            
            const endIndex = monthsMap[endMonth].index;
            
            // è®¡ç®—å®é™…æœ‰æ•°æ®çš„èµ·å§‹ç´¢å¼•
            const dataStartIndex = Math.max(0, endIndex - monthsToShow + 1);
            const actualDataMonths = availableMonths.slice(dataStartIndex, endIndex + 1);
            
            // æ›´æ–°é¡µé¢æ˜¾ç¤º - åªæ˜¾ç¤ºå®é™…æœ‰æ•°æ®çš„èŒƒå›´
            const actualEndMonth = monthsMap[endMonth].name;
            const actualStartMonth = actualDataMonths[0];
            const actualEndMonthName = actualDataMonths[actualDataMonths.length - 1];
            
            document.getElementById('currentRange').textContent = 
                `${timeRange} (æŸ¥è¯¢åˆ°2025å¹´${actualEndMonth}) [æ˜¾ç¤ºï¼š2025å¹´${actualStartMonth} - 2025å¹´${actualEndMonthName}ï¼Œå…±${actualDataMonths.length}ä¸ªæœˆ]`;
            
            console.log(`æ˜¾ç¤ºæ•°æ®èŒƒå›´ï¼š${timeRange}ï¼Œæˆªæ­¢åˆ°${endMonth}`);
            console.log(`å®é™…å›¾è¡¨æ•°æ®ï¼š${actualDataMonths.join('-')}`);
            
            // å®é™…çš„å›¾è¡¨æ›´æ–°é€»è¾‘
            updateChartsWithDateRange(timeRange, endMonth, monthsToShow);
        }
        
        // ç®€å•çš„äº¤äº’æ•ˆæœ
        document.querySelectorAll('.feature-card').forEach(card => {
            card.addEventListener('click', function() {
                const title = this.querySelector('.feature-title').textContent;
                alert(`ğŸ“Š ${title} è¯¦ç»†æ•°æ®\n\nç‚¹å‡»åŠŸèƒ½å¡ç‰‡å¯ä»¥æŸ¥çœ‹è¯¥åŠŸèƒ½çš„è¯¦ç»†å­æŒ‡æ ‡åˆ†æï¼ŒåŒ…æ‹¬ï¼š\nâ€¢ å„é¡¹æ•°æ®çš„è¯¦ç»†è¶‹åŠ¿\nâ€¢ ç”¨æˆ·è¡Œä¸ºåˆ†æ\nâ€¢ åœ°åŒºåˆ†å¸ƒæƒ…å†µ\nâ€¢ ä¼˜åŒ–å»ºè®®`);
            });
        });
        
        // ç»„ç»‡å±‚çº§å’Œå¯¹æ¯”ç»´åº¦çš„äº¤äº’
        document.getElementById('orgLevel').addEventListener('change', function() {
            const level = this.value;
            if (level === 'å¤§åŒºï¼ˆæš‚æ— æ•°æ®ï¼‰' || level === 'åˆ†å…¬å¸ï¼ˆæš‚æ— æ•°æ®ï¼‰') {
                alert('ğŸ’¡ æ¸©é¦¨æç¤º\n\nç›®å‰åªæœ‰æ•´ä½“æ•°æ®ï¼Œå¤§åŒºå’Œåˆ†å…¬å¸å±‚çº§çš„æ•°æ®æš‚æœªæ”¶é›†ã€‚\n\nå¦‚éœ€åˆ†å±‚çº§æ•°æ®åˆ†æï¼Œè¯·è”ç³»æ•°æ®ç®¡ç†å‘˜ã€‚');
                this.value = 'æ•´ä½“'; // é‡ç½®ä¸ºæ•´ä½“
                return;
            }
            console.log(`åˆ‡æ¢åˆ°ç»„ç»‡å±‚çº§ï¼š${level}`);
        });
        
        document.getElementById('compareType').addEventListener('change', function() {
            const type = this.value;
            if (type === 'åŒæ¯”ï¼ˆæš‚æ— æ•°æ®ï¼‰') {
                alert('ğŸ’¡ æ¸©é¦¨æç¤º\n\nç›®å‰åªæœ‰ä»Šå¹´2-6æœˆçš„æ•°æ®ï¼ŒåŒæ¯”åˆ†æéœ€è¦å»å¹´åŒæœŸæ•°æ®ã€‚\n\nå¦‚éœ€åŒæ¯”åˆ†æï¼Œè¯·æä¾›å»å¹´åŒæœŸæ•°æ®ã€‚');
                this.value = 'ç¯æ¯”'; // é‡ç½®ä¸ºç¯æ¯”
                return;
            }
            console.log(`åˆ‡æ¢å¯¹æ¯”ç»´åº¦ï¼š${type}`);
            
            if (type === 'ç»å¯¹å€¼') {
                console.log('åˆ‡æ¢åˆ°ç»å¯¹å€¼æ˜¾ç¤ºæ¨¡å¼');
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ç»å¯¹å€¼æ˜¾ç¤ºé€»è¾‘
            }
        });
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ•°æ®èŒƒå›´æ˜¾ç¤ºï¼ˆä¸æ›´æ–°å›¾è¡¨ï¼‰
        function initializeDataRange() {
            const timeRange = document.getElementById('timeRange').value;
            const endMonth = document.getElementById('endMonth').value;
            
            // æ•°æ®æœˆä»½æ˜ å°„
            const monthsMap = {
                '2025-02': { index: 0, name: '2æœˆ' },
                '2025-03': { index: 1, name: '3æœˆ' },
                '2025-04': { index: 2, name: '4æœˆ' },
                '2025-05': { index: 3, name: '5æœˆ' },
                '2025-06': { index: 4, name: '6æœˆ' }
            };
            
            const availableMonths = ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'];
            
            // è®¡ç®—å®é™…æ˜¾ç¤ºçš„æœˆä»½èŒƒå›´
            const monthsToShow = parseInt(timeRange.replace('æœ€è¿‘', '').replace('ä¸ªæœˆ', ''));
            const endIndex = monthsMap[endMonth].index;
            const startIndex = Math.max(0, endIndex - monthsToShow + 1);
            
            const actualMonths = availableMonths.slice(startIndex, endIndex + 1);
            const startMonth = actualMonths[0];
            const endMonthName = actualMonths[actualMonths.length - 1];
            
            // æ›´æ–°é¡µé¢æ˜¾ç¤ºï¼ˆä½¿ç”¨å®é™…æ•°æ®èŒƒå›´ï¼‰
            document.getElementById('currentRange').textContent = 
                `${timeRange} (æŸ¥è¯¢åˆ°2025å¹´${endMonthName}) [æ˜¾ç¤ºï¼š2025å¹´${startMonth} - 2025å¹´${endMonthName}ï¼Œå…±${actualMonths.length}ä¸ªæœˆ]`;
        }
        
        // é¡µé¢åŠ è½½æ—¶åªåˆå§‹åŒ–æ˜¾ç¤ºï¼Œä¸æ›´æ–°å›¾è¡¨
        initializeDataRange();
        
        // å¼ºåˆ¶é‡ç½®æ‰€æœ‰ç¯æ¯”ä¸º"â€”"ï¼ˆè§£å†³ç¼“å­˜é—®é¢˜ï¼‰
        console.log('ğŸ”§ é¡µé¢åŠ è½½æ—¶å¼ºåˆ¶é‡ç½®æ‰€æœ‰ç¯æ¯”');
        document.querySelectorAll('.metric-card .metric-change').forEach(el => {
            console.log(`ğŸ”„ å¼ºåˆ¶é‡ç½®: ${el.textContent} -> â€”`);
            el.textContent = 'â€”';
            el.className = 'metric-change neutral';
        });
        
        // å¼ºåˆ¶è®¾ç½®ä¸º2æœˆæ•°æ®ï¼ˆä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼‰
        setTimeout(() => {
            console.log('ğŸ”§ å¼ºåˆ¶è°ƒç”¨2æœˆæ•°æ®æ›´æ–°');
            const fullData = {
                months: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                coreMetrics: {
                    'ä¼å¾®å¼€é€šäººæ•°': [30990, 31734, 32913, 33672, 33824],
                    'ä¼å¾®ç™»å½•äººæ•°': [20926, 22941, 27823, 29051, 29247],
                    'ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°': [6489, 8104, 11436, 13285, 13434],
                    'ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°': [4517, 5848, 8254, 10179, 10999]
                }
            };
            updateCoreMetricCards(fullData, 0); // å¼ºåˆ¶ä½¿ç”¨2æœˆæ•°æ®ï¼ˆendIndex=0ï¼‰
            
            // æ¸…ç†ä»»ä½•å¯èƒ½æ®‹ç•™çš„åŠ è½½é®ç½©
            document.querySelectorAll('div').forEach(el => {
                if (el.style.position === 'fixed' && el.style.zIndex === '9999') {
                    el.remove();
                }
            });
            document.body.style.opacity = '1';
        }, 500);
        
        // æ·»åŠ é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function(event) {
            // æŒ‰Enteré”®è§¦å‘æŸ¥è¯¢
            if (event.key === 'Enter' && (event.target.tagName === 'SELECT' || event.target.id === 'queryBtn')) {
                document.getElementById('queryBtn').click();
            }
        });

        // æ•°æ®ç­›é€‰å‡½æ•°
        function updateChartsWithDateRange(timeRange, endMonth, monthsToShow) {
            // å®šä¹‰å®Œæ•´çš„çœŸå®æ•°æ®
            const fullData = {
                months: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                monthsMap: {
                    '2025-02': 0, '2025-03': 1, '2025-04': 2, '2025-05': 3, '2025-06': 4
                },
                coreMetrics: {
                    'ä¼å¾®å¼€é€šäººæ•°': [30990, 31734, 32913, 33672, 33824],
                    'ä¼å¾®ç™»å½•äººæ•°': [20926, 22941, 27823, 29051, 29247],
                    'ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°': [6489, 8104, 11436, 13285, 13434],
                    'ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°': [4517, 5848, 8254, 10179, 10999],
                    'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æ—¥æ´»': [1075, 1572, 1965, 2637, 2904],
                    'ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æ—¥æ´»': [884, 1279, 1604, 2171, 2411],
                    'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æœˆæ´»': [6488, 8102, 11434, 13283, 13434],
                    'ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æœˆæ´»': [4949, 6181, 8545, 9818, 10223]
                },
                modules: {
                    'å¨æˆ¿å¥åº·æ£€æµ‹': {
                        'ä½¿ç”¨äººæ•°': [1168, 1869, 2995, 4410, 6222],
                        'åˆ›å»ºæ•°é‡': [5615, 15504, 26161, 43693, 76320],
                        'åˆ†äº«æ•°é‡': [3276, 8663, 12060, 10028, 27549]
                    },
                    'é€‰è´­æŒ‡å—': {
                        'ä½¿ç”¨äººæ•°': [75, 68, 149, 190, 176],
                        'åˆ›å»º+æ›´æ–°æ•°é‡': [125, 261, 317, 438, 375],
                        'åˆ†äº«æ•°é‡': [112, 231, 248, 198, 320]
                    },
                    'æœ‹å‹åœˆç®¡ç†': {
                        'åˆ›å»ºæ•°é‡': [96, 170, 123, 180, 195],
                        'åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡': [799776, 1354483, 736346, 1451003, 1796130],
                        'å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡': [22717, 36858, 34739, 84353, 95860],
                        'å‘˜å·¥æ‰§è¡Œç‡': [3, 2.7, 4.7, 5.8, 5.3],
                        'è§¦è¾¾é¡¾å®¢æ¬¡æ•°': [2615312, 3980114, 2677486, 5960501, 9581610]
                    },
                    'é—¨åº—æ´»åŠ¨': {
                        'åˆ›å»ºæ•°é‡': [5, 1, 13, 16, 10],
                        'å®¡æ ¸é€šè¿‡æ•°é‡': [2, 0, 6, 11, 3],
                        'æµè§ˆé‡': [43, 1, 21, 87, 0],
                        'è½¬å‘æ•°': [15, 2, 3, 9, 0],
                        'çº¿ç´¢æ•°': [2, 3, 3, 1, 1],
                        'è®¢å•æ•°': [0, 4, 0, 0, 0]
                    },
                    'æ¬¢è¿è¯­': {
                        'åˆ›å»ºæ¡æ•°': [380, 389, 447, 513, 603],
                        'å·²è§¦å‘å¥½å‹æ•°': [369990, 382583, 463006, 641248, 1190926],
                        'æ‰“å¼€æ•°': [239854, 250055, 270790, 297712, 363798],
                        'æ‰“å¼€ç‡': [65, 65, 58, 46, 31],
                        'äº§ç”Ÿçº¿ç´¢æ•°': [30686, 32291, 35036, 38321, 45069],
                        'æ´»è·ƒçº¿ç´¢äº§ç”Ÿç‡': [12.79, 12.91, 12.94, 12.87, 12.39],
                        'æˆäº¤çº¿ç´¢æ•°': [2157, 2220, 2335, 2517, 2899]
                    },
                    'å¨æˆ¿æ¡ˆä¾‹': {
                        'æ€»æ•°é‡': [3981, 3982, 3982, 3982, 5260],
                        'åˆ†äº«é‡': [8790, 13376, 15193, 23377, 19889]
                    },
                    'AIé—®ç­”': {
                        'ä½¿ç”¨äººæ•°': [76, 609, 1244, 1341, 917],
                        'ä½¿ç”¨äººæ¬¡': [369, 1857, 3543, 3568, 2591]
                    },
                    'ç”¨æˆ·æœåŠ¡å¡': {
                        'åˆ†äº«äººæ•°': [0, 0, 85, 108, 285],
                        'åˆ†äº«äººæ¬¡': [0, 0, 558, 439, 2398],
                        'NPSäººæ•°': [0, 0, 98, 85, 252],
                        'NPSè¯„åˆ†': [0, 0, 9.783, 9.882, 9.888]
                    }
                }
            };
            
            // è®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œä¾›å¯¼å‡ºåŠŸèƒ½ä½¿ç”¨
            window.fullData = fullData;
            
            // æ ¹æ®æ—¶é—´èŒƒå›´ç­›é€‰æ•°æ® - ä»¥é€‰æ‹©æœˆä»½ä¸ºç»ˆç‚¹å‘å‰æ¨ç®—
            const endIndex = fullData.monthsMap[endMonth] || 4; // é»˜è®¤6æœˆ
            
            console.log(`ç­›é€‰å‚æ•°ï¼šæ—¶é—´èŒƒå›´=${timeRange}, ç»“æŸæœˆä»½=${endMonth}, æœˆä»½æ•°=${monthsToShow}`);
            console.log(`è®¡ç®—ç»“æœï¼šendIndex=${endIndex}`);
            
            // ç”Ÿæˆå›¾è¡¨æ˜¾ç¤ºçš„æœˆä»½æ ‡ç­¾å’Œæ•°æ®æ•°ç»„
            const displayMonths = [];
            const displayData = {
                'ä¼å¾®å¼€é€šäººæ•°': [],
                'ä¼å¾®ç™»å½•äººæ•°': [],
                'ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°': [],
                'ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°': [],
                'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æ—¥æ´»': [],
                'å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æœˆæ´»': [],
                'ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æ—¥æ´»': [],
                'ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æœˆæ´»': []
            };
            
            // ä¿®æ”¹é€»è¾‘ï¼šæ˜¾ç¤ºå®Œæ•´çš„æ—¶é—´è½´ï¼Œä»é€‰æ‹©çš„å¹´æœˆå¾€å‰æ¨ç®—
            // è§£æé€‰æ‹©çš„å¹´æœˆ
            const selectedYear = parseInt(endMonth.split('-')[0]); // 2025
            const selectedMonth = parseInt(endMonth.split('-')[1]); // 2 (2æœˆ)
            
            console.log(`é€‰æ‹©çš„å¹´æœˆï¼š${selectedYear}å¹´${selectedMonth}æœˆ`);
            
            // ä»é€‰æ‹©çš„å¹´æœˆå¾€å‰æ¨ç®—å®Œæ•´çš„æ—¶é—´è½´
            for (let i = 0; i < monthsToShow; i++) {
                // è®¡ç®—å½“å‰è¦æ˜¾ç¤ºçš„æœˆä»½ï¼ˆä»æœ€æ—©çš„å¼€å§‹ï¼‰
                let displayYear = selectedYear;
                let displayMonth = selectedMonth - (monthsToShow - 1 - i);
                
                // å¤„ç†æœˆä»½å°äº1çš„æƒ…å†µï¼ˆè·¨å¹´ï¼‰
                while (displayMonth <= 0) {
                    displayMonth += 12;
                    displayYear -= 1;
                }
                
                // ç”Ÿæˆæœˆä»½æ ‡ç­¾
                let monthLabel;
                if (displayYear === selectedYear) {
                    monthLabel = `${displayMonth}æœˆ`;
                } else {
                    monthLabel = `${displayMonth}æœˆ(${displayYear}å¹´)`;
                }
                
                displayMonths.push(monthLabel);
                
                // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®ï¼šåªæœ‰2025å¹´2-6æœˆæœ‰æ•°æ®
                let dataIndex = -1;
                if (displayYear === 2025 && displayMonth >= 2 && displayMonth <= 6) {
                    // åœ¨æˆ‘ä»¬çš„æ•°æ®èŒƒå›´å†…ï¼Œè®¡ç®—å¯¹åº”çš„æ•°ç»„ç´¢å¼•
                    dataIndex = displayMonth - 2; // 2æœˆ->0, 3æœˆ->1, 4æœˆ->2, 5æœˆ->3, 6æœˆ->4
                }
                
                console.log(`æœˆä»½ï¼š${monthLabel}, å¹´ï¼š${displayYear}, æœˆï¼š${displayMonth}, æ•°æ®ç´¢å¼•ï¼š${dataIndex}`);
                
                // å¡«å……æ•°æ®ï¼Œæœ‰æ•°æ®çš„æœˆä»½ç”¨å®é™…æ•°æ®ï¼Œæ²¡æ•°æ®çš„ç”¨null
                Object.keys(displayData).forEach(key => {
                    if (dataIndex !== -1) {
                        displayData[key].push(fullData.coreMetrics[key][dataIndex]);
                    } else {
                        displayData[key].push(null); // Chart.jsä¼šå°†nullæ˜¾ç¤ºä¸ºç©ºç‚¹
                    }
                });
            }
            
            console.log(`æ˜¾ç¤ºå®Œæ•´æ—¶é—´è½´ï¼š${monthsToShow}ä¸ªæœˆï¼Œç»“æŸäº${fullData.months[endIndex]}`);
            
            console.log('å›¾è¡¨æ˜¾ç¤ºæœˆä»½ï¼š', displayMonths);
            console.log('å›¾è¡¨æ•°æ®ç¤ºä¾‹ï¼ˆå¼€é€šäººæ•°ï¼‰ï¼š', displayData['ä¼å¾®å¼€é€šäººæ•°']);
            
            // æ›´æ–°ä¸»è¦è¶‹åŠ¿å›¾è¡¨
            if (window.usageTrendChart) {
                window.usageTrendChart.data.labels = displayMonths;
                
                console.log('ä¸»è¶‹åŠ¿å›¾æ•°æ®æ›´æ–°ï¼š');
                console.log('- ä¼å¾®å¼€é€šäººæ•°:', displayData['ä¼å¾®å¼€é€šäººæ•°']);
                console.log('- ä¼å¾®ç™»å½•äººæ•°:', displayData['ä¼å¾®ç™»å½•äººæ•°']);
                console.log('- ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°:', displayData['ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°']);
                console.log('- ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°:', displayData['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°']);
                
                window.usageTrendChart.data.datasets[0].data = displayData['ä¼å¾®å¼€é€šäººæ•°'];
                window.usageTrendChart.data.datasets[1].data = displayData['ä¼å¾®ç™»å½•äººæ•°'];
                window.usageTrendChart.data.datasets[2].data = displayData['ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°'];
                window.usageTrendChart.data.datasets[3].data = displayData['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°'];
                window.usageTrendChart.update();
            }
            
            // æ›´æ–°æ—¥æ´»å›¾è¡¨
            if (window.dailyActiveChart) {
                window.dailyActiveChart.data.labels = displayMonths;
                window.dailyActiveChart.data.datasets[0].data = displayData['å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æ—¥æ´»'];
                window.dailyActiveChart.data.datasets[1].data = displayData['ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æ—¥æ´»'];
                window.dailyActiveChart.update();
            }
            
            // æ›´æ–°æœˆæ´»å›¾è¡¨
            if (window.monthlyActiveChart) {
                window.monthlyActiveChart.data.labels = displayMonths;
                window.monthlyActiveChart.data.datasets[0].data = displayData['å…¨ä½“ä¼å¾®æ™ºæ…§å¯¼è´­æœˆæ´»'];
                window.monthlyActiveChart.data.datasets[1].data = displayData['ä¸‰ç±»äººå‘˜ä¼å¾®æ™ºæ…§æœˆæ´»'];
                window.monthlyActiveChart.update();
            }
            
            // æ›´æ–°å¢é•¿ç‡æ’è¡Œå›¾è¡¨ - æ˜¾ç¤ºé€‰æ‹©æœˆä»½æ‰€æœ‰æŒ‡æ ‡çš„ç¯æ¯”å¢é•¿ç‡
            if (window.growthChart) {
                // å¦‚æœé€‰æ‹©çš„æ˜¯2æœˆï¼ˆç´¢å¼•0ï¼‰ï¼Œåˆ™æ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼Œå› ä¸ºæ²¡æœ‰ç¯æ¯”æ•°æ®
                if (endIndex === 0) {
                    window.growthChart.data.labels = ['2æœˆä¸ºèµ·å§‹æœˆä»½ï¼Œæ— ç¯æ¯”å¢é•¿ç‡æ•°æ®'];
                    window.growthChart.data.datasets[0].data = [0];
                    window.growthChart.update();
                    console.log('2æœˆæ˜¯èµ·å§‹æœˆä»½ï¼Œæ— æ³•è®¡ç®—ç¯æ¯”å¢é•¿ç‡');
                    // ä¸è¦returnï¼Œç»§ç»­æ‰§è¡ŒupdateCoreMetricCards
                } else {
                
                // è®¡ç®—å½“å‰é€‰æ‹©æœˆä»½çš„ç¯æ¯”å¢é•¿ç‡
                const calculateMonthGrowthRate = (data, monthIndex) => {
                    if (monthIndex <= 0 || monthIndex >= data.length || data[monthIndex] === null || data[monthIndex - 1] === null) return null;
                    const current = data[monthIndex];
                    const previous = data[monthIndex - 1];
                    return previous > 0 ? ((current - previous) / previous * 100) : null;
                };
                
                const allGrowthRates = [];
                
                // æ ¸å¿ƒæŒ‡æ ‡
                Object.keys(fullData.coreMetrics).forEach(metricName => {
                    const rate = calculateMonthGrowthRate(fullData.coreMetrics[metricName], endIndex);
                    if (rate !== null) {
                        allGrowthRates.push({ 
                            name: `æ ¸å¿ƒæŒ‡æ ‡-${metricName}`, 
                            rate: parseFloat(rate.toFixed(1)) 
                        });
                    }
                });
                
                // åŠŸèƒ½æ¨¡å—æŒ‡æ ‡
                Object.keys(fullData.modules).forEach(moduleName => {
                    Object.keys(fullData.modules[moduleName]).forEach(metricName => {
                        const rate = calculateMonthGrowthRate(fullData.modules[moduleName][metricName], endIndex);
                        if (rate !== null) {
                            allGrowthRates.push({ 
                                name: `${moduleName}-${metricName}`, 
                                rate: parseFloat(rate.toFixed(1)) 
                            });
                        }
                    });
                });
                
                // æŒ‰å¢é•¿ç‡æ’åºï¼Œå–å‰10å
                const topGrowthRates = allGrowthRates
                    .sort((a, b) => b.rate - a.rate)
                    .slice(0, 10);
                
                console.log(`${fullData.months[endIndex]}æœˆç¯æ¯”å¢é•¿ç‡æ’è¡Œï¼š`, topGrowthRates);
                
                window.growthChart.data.labels = topGrowthRates.map(item => item.name);
                window.growthChart.data.datasets[0].data = topGrowthRates.map(item => item.rate);
                window.growthChart.update();
                }
            }
            
            // æ›´æ–°æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡æ•°æ®
            updateCoreMetricCards(fullData, endIndex);
            
            // æ›´æ–°åŠŸèƒ½æ¨¡å—å¡ç‰‡æ•°æ®
            updateFeatureModuleCards(fullData, endIndex);
            
            console.log(`æ•°æ®å·²æ›´æ–°ï¼šæ˜¾ç¤º${endMonth}çš„æ•°æ®`);
        }
        
        // æ›´æ–°æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡æ•°æ®
        function updateCoreMetricCards(fullData, endIndex) {
            console.log(`ğŸ” updateCoreMetricCardsè¢«è°ƒç”¨: endIndex=${endIndex}, æœˆä»½=${fullData.months[endIndex]}`);
            
            // æ£€æŸ¥å½“å‰é€‰æ‹©çš„æœˆä»½
            const selectedMonth = document.getElementById('endMonth').value;
            console.log(`ğŸ” å½“å‰é€‰æ‹©çš„æœˆä»½: ${selectedMonth}`);
            
            // å¦‚æœé€‰æ‹©çš„æ˜¯2æœˆï¼Œå¼ºåˆ¶æ‰€æœ‰ç¯æ¯”ä¸º"â€”"
            if (selectedMonth === '2025-02') {
                console.log('ğŸš« æ£€æµ‹åˆ°é€‰æ‹©2æœˆï¼Œå¼ºåˆ¶æ‰€æœ‰ç¯æ¯”ä¸º"â€”"');
                document.querySelectorAll('.metric-card .metric-change').forEach(el => {
                    el.textContent = 'â€”';
                    el.className = 'metric-change neutral';
                });
                // æ›´æ–°æ•°å€¼ä¸º2æœˆæ•°æ®
                document.querySelector('.metric-card:nth-child(1) .metric-value').textContent = '30,990';
                document.querySelector('.metric-card:nth-child(2) .metric-value').textContent = '20,926';
                document.querySelector('.metric-card:nth-child(3) .metric-value').textContent = '6,489';
                document.querySelector('.metric-card:nth-child(4) .metric-value').textContent = '4,517';
                return; // ç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œåç»­é€»è¾‘
            }
            
            // å…ˆå…¨éƒ¨é‡ç½®ä¸º"â€”"
            document.querySelectorAll('.metric-card .metric-change').forEach(el => {
                console.log(`ğŸ”„ é‡ç½®ç¯æ¯”å…ƒç´ : ${el.textContent} -> â€”`);
                el.textContent = 'â€”';
                el.className = 'metric-change neutral';
            });
            const currentMonth = fullData.months[endIndex];
            // æ›´æ–°ä¼å¾®å¼€é€šäººæ•°
            const openCount = fullData.coreMetrics['ä¼å¾®å¼€é€šäººæ•°'][endIndex];
            document.querySelector('.metric-card:nth-child(1) .metric-value').textContent = openCount.toLocaleString();
            // æ›´æ–°ä¼å¾®ç™»å½•äººæ•°
            const loginCount = fullData.coreMetrics['ä¼å¾®ç™»å½•äººæ•°'][endIndex];
            document.querySelector('.metric-card:nth-child(2) .metric-value').textContent = loginCount.toLocaleString();
            // æ›´æ–°ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°
            const visitCount = fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°'][endIndex];
            document.querySelector('.metric-card:nth-child(3) .metric-value').textContent = visitCount.toLocaleString();
            // æ›´æ–°ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°
            const usageCount = fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°'][endIndex];
            document.querySelector('.metric-card:nth-child(4) .metric-value').textContent = usageCount.toLocaleString();
            // åªæœ‰ä¸æ˜¯ç¬¬ä¸€ä¸ªæœˆæ‰æ˜¾ç¤ºç¯æ¯”
            if (endIndex > 0) {
                // ä¼å¾®å¼€é€šäººæ•°ç¯æ¯”
                const openPrev = fullData.coreMetrics['ä¼å¾®å¼€é€šäººæ•°'][endIndex - 1];
                const openChange = ((openCount - openPrev) / openPrev * 100).toFixed(1);
                const openChangeEl = document.querySelector('.metric-card:nth-child(1) .metric-change');
                openChangeEl.textContent = `ğŸ“Š ç¯æ¯” ${openChange >= 0 ? '+' : ''}${openChange}%`;
                openChangeEl.className = `metric-change ${openChange >= 0 ? 'positive' : 'negative'}`;
                // ä¼å¾®ç™»å½•äººæ•°ç¯æ¯”
                const loginPrev = fullData.coreMetrics['ä¼å¾®ç™»å½•äººæ•°'][endIndex - 1];
                const loginChange = ((loginCount - loginPrev) / loginPrev * 100).toFixed(1);
                const loginChangeEl = document.querySelector('.metric-card:nth-child(2) .metric-change');
                loginChangeEl.textContent = `ğŸ“Š ç¯æ¯” ${loginChange >= 0 ? '+' : ''}${loginChange}%`;
                loginChangeEl.className = `metric-change ${loginChange >= 0 ? 'positive' : 'negative'}`;
                // æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°ç¯æ¯”
                const visitPrev = fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­è®¿é—®äººæ•°'][endIndex - 1];
                const visitChange = ((visitCount - visitPrev) / visitPrev * 100).toFixed(1);
                const visitChangeEl = document.querySelector('.metric-card:nth-child(3) .metric-change');
                visitChangeEl.textContent = `ğŸ“Š ç¯æ¯” ${visitChange >= 0 ? '+' : ''}${visitChange}%`;
                visitChangeEl.className = `metric-change ${visitChange >= 0 ? 'positive' : 'negative'}`;
                // æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°ç¯æ¯”
                const usagePrev = fullData.coreMetrics['ä¼å¾®æ™ºæ…§å¯¼è´­ä½¿ç”¨äººæ•°'][endIndex - 1];
                const usageChange = ((usageCount - usagePrev) / usagePrev * 100).toFixed(1);
                const usageChangeEl = document.querySelector('.metric-card:nth-child(4) .metric-change');
                usageChangeEl.textContent = `ğŸ“Š ç¯æ¯” ${usageChange >= 0 ? '+' : ''}${usageChange}%`;
                usageChangeEl.className = `metric-change ${usageChange >= 0 ? 'positive' : 'negative'}`;
            }
        }

        // æ›´æ–°åŠŸèƒ½æ¨¡å—å¡ç‰‡æ•°æ®
        function updateFeatureModuleCards(fullData, endIndex) {
            console.log(`ğŸ” updateFeatureModuleCardsè¢«è°ƒç”¨: endIndex=${endIndex}`);
            
            // æ£€æŸ¥å½“å‰é€‰æ‹©çš„æœˆä»½
            const selectedMonth = document.getElementById('endMonth').value;
            
            // å¦‚æœé€‰æ‹©çš„æ˜¯2æœˆï¼ŒåŠŸèƒ½æ¨¡å—ä¹Ÿæ˜¾ç¤º"â€”"
            if (selectedMonth === '2025-02') {
                console.log('ğŸš« 2æœˆï¼šåŠŸèƒ½æ¨¡å—æ‰€æœ‰ç¯æ¯”è®¾ä¸º"â€”"');
                document.querySelectorAll('.feature-card .metric-change').forEach(el => {
                    el.textContent = 'â€”';
                    el.className = 'metric-change neutral';
                });
                // æ›´æ–°æ‰€æœ‰æ¨¡å—çš„æ•°å€¼ä¸º2æœˆæ•°æ®
                updateFeatureModuleValues(fullData, 0);
                return;
            }
            
            // è®¡ç®—å’Œæ›´æ–°åŠŸèƒ½æ¨¡å—çš„ç¯æ¯”
            updateFeatureModuleValues(fullData, endIndex);
            updateFeatureModuleChanges(fullData, endIndex);
        }
        
        // æ›´æ–°åŠŸèƒ½æ¨¡å—çš„æ•°å€¼
        function updateFeatureModuleValues(fullData, endIndex) {
            // å¨æˆ¿å¥åº·æ£€æµ‹
            const healthCard = document.querySelector('.feature-card:nth-child(1)');
            healthCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['ä½¿ç”¨äººæ•°'][endIndex].toLocaleString();
            healthCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ›å»ºæ•°é‡'][endIndex].toLocaleString();
            healthCard.querySelector('.metric-item:nth-child(3) .metric-value').textContent = fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ†äº«æ•°é‡'][endIndex].toLocaleString();
            
            // æ¬¢è¿è¯­ç®¡ç†
            const welcomeCard = document.querySelector('.feature-card:nth-child(2)');
            welcomeCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['æ¬¢è¿è¯­']['å·²è§¦å‘å¥½å‹æ•°'][endIndex].toLocaleString();
            welcomeCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['æ¬¢è¿è¯­']['æ‰“å¼€æ•°'][endIndex].toLocaleString();
            welcomeCard.querySelector('.metric-item:nth-child(3) .metric-value').textContent = fullData.modules['æ¬¢è¿è¯­']['äº§ç”Ÿçº¿ç´¢æ•°'][endIndex].toLocaleString();
            
            // æœ‹å‹åœˆç®¡ç†
            const friendsCard = document.querySelector('.feature-card:nth-child(3)');
            friendsCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['æœ‹å‹åœˆç®¡ç†']['åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡'][endIndex].toLocaleString();
            friendsCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['æœ‹å‹åœˆç®¡ç†']['åˆ›å»ºæ•°é‡'][endIndex].toLocaleString();
            friendsCard.querySelector('.metric-item:nth-child(3) .metric-value').textContent = fullData.modules['æœ‹å‹åœˆç®¡ç†']['å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡'][endIndex].toLocaleString();
            
            // é€‰è´­æŒ‡å—
            const guideCard = document.querySelector('.feature-card:nth-child(4)');
            guideCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['é€‰è´­æŒ‡å—']['ä½¿ç”¨äººæ•°'][endIndex].toLocaleString();
            guideCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['é€‰è´­æŒ‡å—']['åˆ›å»º+æ›´æ–°æ•°é‡'][endIndex].toLocaleString();
            guideCard.querySelector('.metric-item:nth-child(3) .metric-value').textContent = fullData.modules['é€‰è´­æŒ‡å—']['åˆ†äº«æ•°é‡'][endIndex].toLocaleString();
            
            // AIé—®ç­”
            const aiCard = document.querySelector('.feature-card:nth-child(5)');
            aiCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['AIé—®ç­”']['ä½¿ç”¨äººæ•°'][endIndex].toLocaleString();
            aiCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['AIé—®ç­”']['ä½¿ç”¨äººæ¬¡'][endIndex].toLocaleString();
            
            // é—¨åº—æ´»åŠ¨
            const storeCard = document.querySelector('.feature-card:nth-child(6)');
            storeCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['é—¨åº—æ´»åŠ¨']['åˆ›å»ºæ•°é‡'][endIndex].toLocaleString();
            storeCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['é—¨åº—æ´»åŠ¨']['å®¡æ ¸é€šè¿‡æ•°é‡'][endIndex].toLocaleString();
            storeCard.querySelector('.metric-item:nth-child(3) .metric-value').textContent = fullData.modules['é—¨åº—æ´»åŠ¨']['æµè§ˆé‡'][endIndex].toLocaleString();
            
            // å¨æˆ¿æ¡ˆä¾‹
            const caseCard = document.querySelector('.feature-card:nth-child(7)');
            caseCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['å¨æˆ¿æ¡ˆä¾‹']['æ€»æ•°é‡'][endIndex].toLocaleString();
            caseCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['å¨æˆ¿æ¡ˆä¾‹']['åˆ†äº«é‡'][endIndex].toLocaleString();
            
            // ç”¨æˆ·æœåŠ¡å¡
            const serviceCard = document.querySelector('.feature-card:nth-child(8)');
            serviceCard.querySelector('.metric-item:nth-child(1) .metric-value').textContent = fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['åˆ†äº«äººæ•°'][endIndex].toLocaleString();
            serviceCard.querySelector('.metric-item:nth-child(2) .metric-value').textContent = fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['åˆ†äº«äººæ¬¡'][endIndex].toLocaleString();
            serviceCard.querySelector('.metric-item:nth-child(3) .metric-value').textContent = fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['NPSè¯„åˆ†'][endIndex].toLocaleString();
        }
        
        // æ›´æ–°åŠŸèƒ½æ¨¡å—çš„ç¯æ¯”å˜åŒ–
        function updateFeatureModuleChanges(fullData, endIndex) {
            if (endIndex === 0) return; // 2æœˆæ²¡æœ‰ç¯æ¯”
            
            // è®¡ç®—ç¯æ¯”çš„é€šç”¨å‡½æ•°
            const calculateChange = (current, previous) => {
                if (previous === 0) return current > 0 ? 100 : 0;
                return Math.round(((current - previous) / previous) * 100);
            };
            
            // å¨æˆ¿å¥åº·æ£€æµ‹
            const healthCard = document.querySelector('.feature-card:nth-child(1)');
            updateModuleCardChange(healthCard, 1, calculateChange(fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['ä½¿ç”¨äººæ•°'][endIndex], fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['ä½¿ç”¨äººæ•°'][endIndex-1]));
            updateModuleCardChange(healthCard, 2, calculateChange(fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ›å»ºæ•°é‡'][endIndex], fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ›å»ºæ•°é‡'][endIndex-1]));
            updateModuleCardChange(healthCard, 3, calculateChange(fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ†äº«æ•°é‡'][endIndex], fullData.modules['å¨æˆ¿å¥åº·æ£€æµ‹']['åˆ†äº«æ•°é‡'][endIndex-1]));
            
            // æ¬¢è¿è¯­ç®¡ç†
            const welcomeCard = document.querySelector('.feature-card:nth-child(2)');
            updateModuleCardChange(welcomeCard, 1, calculateChange(fullData.modules['æ¬¢è¿è¯­']['å·²è§¦å‘å¥½å‹æ•°'][endIndex], fullData.modules['æ¬¢è¿è¯­']['å·²è§¦å‘å¥½å‹æ•°'][endIndex-1]));
            updateModuleCardChange(welcomeCard, 2, calculateChange(fullData.modules['æ¬¢è¿è¯­']['æ‰“å¼€æ•°'][endIndex], fullData.modules['æ¬¢è¿è¯­']['æ‰“å¼€æ•°'][endIndex-1]));
            updateModuleCardChange(welcomeCard, 3, calculateChange(fullData.modules['æ¬¢è¿è¯­']['äº§ç”Ÿçº¿ç´¢æ•°'][endIndex], fullData.modules['æ¬¢è¿è¯­']['äº§ç”Ÿçº¿ç´¢æ•°'][endIndex-1]));
            
            // æœ‹å‹åœˆç®¡ç†
            const friendsCard = document.querySelector('.feature-card:nth-child(3)');
            updateModuleCardChange(friendsCard, 1, calculateChange(fullData.modules['æœ‹å‹åœˆç®¡ç†']['åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡'][endIndex], fullData.modules['æœ‹å‹åœˆç®¡ç†']['åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡'][endIndex-1]));
            updateModuleCardChange(friendsCard, 2, calculateChange(fullData.modules['æœ‹å‹åœˆç®¡ç†']['åˆ›å»ºæ•°é‡'][endIndex], fullData.modules['æœ‹å‹åœˆç®¡ç†']['åˆ›å»ºæ•°é‡'][endIndex-1]));
            updateModuleCardChange(friendsCard, 3, calculateChange(fullData.modules['æœ‹å‹åœˆç®¡ç†']['å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡'][endIndex], fullData.modules['æœ‹å‹åœˆç®¡ç†']['å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡'][endIndex-1]));
            
            // é€‰è´­æŒ‡å—
            const guideCard = document.querySelector('.feature-card:nth-child(4)');
            updateModuleCardChange(guideCard, 1, calculateChange(fullData.modules['é€‰è´­æŒ‡å—']['ä½¿ç”¨äººæ•°'][endIndex], fullData.modules['é€‰è´­æŒ‡å—']['ä½¿ç”¨äººæ•°'][endIndex-1]));
            updateModuleCardChange(guideCard, 2, calculateChange(fullData.modules['é€‰è´­æŒ‡å—']['åˆ›å»º+æ›´æ–°æ•°é‡'][endIndex], fullData.modules['é€‰è´­æŒ‡å—']['åˆ›å»º+æ›´æ–°æ•°é‡'][endIndex-1]));
            updateModuleCardChange(guideCard, 3, calculateChange(fullData.modules['é€‰è´­æŒ‡å—']['åˆ†äº«æ•°é‡'][endIndex], fullData.modules['é€‰è´­æŒ‡å—']['åˆ†äº«æ•°é‡'][endIndex-1]));
            
            // AIé—®ç­”
            const aiCard = document.querySelector('.feature-card:nth-child(5)');
            updateModuleCardChange(aiCard, 1, calculateChange(fullData.modules['AIé—®ç­”']['ä½¿ç”¨äººæ•°'][endIndex], fullData.modules['AIé—®ç­”']['ä½¿ç”¨äººæ•°'][endIndex-1]));
            updateModuleCardChange(aiCard, 2, calculateChange(fullData.modules['AIé—®ç­”']['ä½¿ç”¨äººæ¬¡'][endIndex], fullData.modules['AIé—®ç­”']['ä½¿ç”¨äººæ¬¡'][endIndex-1]));
            
            // é—¨åº—æ´»åŠ¨
            const storeCard = document.querySelector('.feature-card:nth-child(6)');
            updateModuleCardChange(storeCard, 1, calculateChange(fullData.modules['é—¨åº—æ´»åŠ¨']['åˆ›å»ºæ•°é‡'][endIndex], fullData.modules['é—¨åº—æ´»åŠ¨']['åˆ›å»ºæ•°é‡'][endIndex-1]));
            updateModuleCardChange(storeCard, 2, calculateChange(fullData.modules['é—¨åº—æ´»åŠ¨']['å®¡æ ¸é€šè¿‡æ•°é‡'][endIndex], fullData.modules['é—¨åº—æ´»åŠ¨']['å®¡æ ¸é€šè¿‡æ•°é‡'][endIndex-1]));
            updateModuleCardChange(storeCard, 3, calculateChange(fullData.modules['é—¨åº—æ´»åŠ¨']['æµè§ˆé‡'][endIndex], fullData.modules['é—¨åº—æ´»åŠ¨']['æµè§ˆé‡'][endIndex-1]));
            
            // å¨æˆ¿æ¡ˆä¾‹
            const caseCard = document.querySelector('.feature-card:nth-child(7)');
            updateModuleCardChange(caseCard, 1, calculateChange(fullData.modules['å¨æˆ¿æ¡ˆä¾‹']['æ€»æ•°é‡'][endIndex], fullData.modules['å¨æˆ¿æ¡ˆä¾‹']['æ€»æ•°é‡'][endIndex-1]));
            updateModuleCardChange(caseCard, 2, calculateChange(fullData.modules['å¨æˆ¿æ¡ˆä¾‹']['åˆ†äº«é‡'][endIndex], fullData.modules['å¨æˆ¿æ¡ˆä¾‹']['åˆ†äº«é‡'][endIndex-1]));
            
            // ç”¨æˆ·æœåŠ¡å¡
            const serviceCard = document.querySelector('.feature-card:nth-child(8)');
            updateModuleCardChange(serviceCard, 1, calculateChange(fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['åˆ†äº«äººæ•°'][endIndex], fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['åˆ†äº«äººæ•°'][endIndex-1]));
            updateModuleCardChange(serviceCard, 2, calculateChange(fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['åˆ†äº«äººæ¬¡'][endIndex], fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['åˆ†äº«äººæ¬¡'][endIndex-1]));
            updateModuleCardChange(serviceCard, 3, calculateChange(fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['NPSè¯„åˆ†'][endIndex], fullData.modules['ç”¨æˆ·æœåŠ¡å¡']['NPSè¯„åˆ†'][endIndex-1]));
        }
        
        // æ›´æ–°å•ä¸ªæ¨¡å—å¡ç‰‡çš„ç¯æ¯”å˜åŒ–
        function updateModuleCardChange(card, metricIndex, changePercent) {
            const changeEl = card.querySelector(`.metric-item:nth-child(${metricIndex}) .metric-change`);
            
            if (changePercent === 0) {
                changeEl.textContent = '0%';
                changeEl.className = 'metric-change neutral';
            } else if (changePercent > 0) {
                changeEl.textContent = `+${changePercent}%`;
                changeEl.className = 'metric-change positive';
            } else {
                changeEl.textContent = `${changePercent}%`;
                changeEl.className = 'metric-change negative';
            }
        }

    // è¯¦æƒ…å¼¹çª—åŠŸèƒ½
    const moduleDetails = {
        'å¨æˆ¿å¥åº·æ£€æµ‹': {
            title: 'ğŸ¥ å¨æˆ¿å¥åº·æ£€æµ‹è¯¦æƒ…',
            metrics: [
                { title: 'ä½¿ç”¨äººæ•°', value: '6,222', change: '+41%', type: 'positive' },
                { title: 'åˆ›å»ºæ•°é‡', value: '76,320', change: '+75%', type: 'positive' },
                { title: 'åˆ†äº«æ¬¡æ•°', value: '27,549', change: '+175%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'ä½¿ç”¨äººæ•°',
                        data: [1168, 1869, 2995, 4410, 6222],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ›å»ºæ•°é‡',
                        data: [5615, 15504, 26161, 43693, 76320],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«æ¬¡æ•°',
                        data: [3276, 8663, 12060, 10028, 27549],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'é€‰è´­æŒ‡å—': {
            title: 'ğŸ›’ é€‰è´­æŒ‡å—è¯¦æƒ…',
            metrics: [
                { title: 'ä½¿ç”¨äººæ•°', value: '176', change: '-7%', type: 'negative' },
                { title: 'åˆ›å»º+æ›´æ–°æ•°é‡', value: '375', change: '-14%', type: 'negative' },
                { title: 'åˆ†äº«æ•°é‡', value: '320', change: '+62%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'ä½¿ç”¨äººæ•°',
                        data: [75, 68, 149, 190, 176],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ›å»º+æ›´æ–°æ•°é‡',
                        data: [125, 261, 317, 438, 375],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«æ•°é‡',
                        data: [112, 231, 248, 198, 320],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'æœ‹å‹åœˆç®¡ç†': {
            title: 'ğŸ‘¥ æœ‹å‹åœˆç®¡ç†è¯¦æƒ…',
            metrics: [
                { title: 'åˆ›å»ºæ•°é‡', value: '195', change: '+8%', type: 'positive' },
                { title: 'åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡', value: '1,796,130', change: '+24%', type: 'positive' },
                { title: 'å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡', value: '95,860', change: '+14%', type: 'positive' },
                { title: 'å‘˜å·¥æ‰§è¡Œç‡', value: '5.3%', change: '-8%', type: 'negative' },
                { title: 'è§¦è¾¾é¡¾å®¢æ¬¡æ•°', value: '9,581,610', change: '+61%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ›å»ºæ•°é‡',
                        data: [96, 170, 123, 180, 195],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åº”æ‰§è¡Œå‘˜å·¥äººæ¬¡',
                        data: [998340, 1456890, 1389120, 1448290, 1796130],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å·²æ‰§è¡Œå‘˜å·¥äººæ¬¡',
                        data: [29950, 39261, 65338, 84003, 95860],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å‘˜å·¥æ‰§è¡Œç‡(%)',
                        data: [3, 2.7, 4.7, 5.8, 5.3],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'è§¦è¾¾é¡¾å®¢æ¬¡æ•°',
                        data: [4789000, 6234000, 7456000, 8912000, 9581610],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'é—¨åº—æ´»åŠ¨': {
            title: 'ğŸª é—¨åº—æ´»åŠ¨è¯¦æƒ…',
            metrics: [
                { title: 'åˆ›å»ºæ•°é‡', value: '10', change: '-38%', type: 'negative' },
                { title: 'å®¡æ ¸é€šè¿‡æ•°é‡', value: '3', change: '-73%', type: 'negative' },
                { title: 'æµè§ˆé‡', value: '0', change: '-100%', type: 'negative' },
                { title: 'è½¬å‘æ•°', value: '0', change: '-100%', type: 'negative' },
                { title: 'çº¿ç´¢æ•°', value: '1', change: '0%', type: 'neutral' },
                { title: 'è®¢å•æ•°', value: '0', change: '0%', type: 'neutral' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ›å»ºæ•°é‡',
                        data: [5, 1, 13, 16, 10],
                        borderColor: '#EF4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å®¡æ ¸é€šè¿‡æ•°é‡',
                        data: [2, 0, 6, 11, 3],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æµè§ˆé‡',
                        data: [43, 1, 21, 87, 0],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'è½¬å‘æ•°',
                        data: [12, 0, 8, 23, 0],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'çº¿ç´¢æ•°',
                        data: [3, 0, 2, 4, 1],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'è®¢å•æ•°',
                        data: [1, 0, 0, 1, 0],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'æ¬¢è¿è¯­': {
            title: 'ğŸ‘‹ æ¬¢è¿è¯­è¯¦æƒ…',
            metrics: [
                { title: 'åˆ›å»ºæ¡æ•°(ç´¯è®¡)', value: '603', change: '+18%', type: 'positive' },
                { title: 'å·²è§¦å‘å¥½å‹æ•°(ç´¯è®¡)', value: '1,190,926', change: '+86%', type: 'positive' },
                { title: 'æ‰“å¼€æ•°(ç´¯è®¡)', value: '363,798', change: '+22%', type: 'positive' },
                { title: 'æ‰“å¼€ç‡(ç´¯è®¡)', value: '31%', change: '-34%', type: 'negative' },
                { title: 'äº§ç”Ÿçº¿ç´¢æ•°(ç´¯è®¡)', value: '45,069', change: '+18%', type: 'positive' },
                { title: 'çº¿ç´¢äº§ç”Ÿç‡(ç´¯è®¡)', value: '12.39%', change: '-4%', type: 'negative' },
                { title: 'æˆäº¤çº¿ç´¢æ•°(ç´¯è®¡)', value: '2,899', change: '+15%', type: 'positive' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ›å»ºæ¡æ•°(ç´¯è®¡)',
                        data: [380, 389, 447, 513, 603],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'å·²è§¦å‘å¥½å‹æ•°(ç´¯è®¡)',
                        data: [640000, 780000, 890000, 1020000, 1190926],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æ‰“å¼€æ•°(ç´¯è®¡)',
                        data: [195000, 238000, 267000, 295000, 363798],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æ‰“å¼€ç‡(%)',
                        data: [65, 65, 58, 46, 31],
                        borderColor: '#EF4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'äº§ç”Ÿçº¿ç´¢æ•°(ç´¯è®¡)',
                        data: [25000, 30000, 34500, 38200, 45069],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'çº¿ç´¢äº§ç”Ÿç‡(%)',
                        data: [12.79, 12.91, 12.94, 12.87, 12.39],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'æˆäº¤çº¿ç´¢æ•°(ç´¯è®¡)',
                        data: [1890, 2123, 2398, 2520, 2899],
                        borderColor: '#14B8A6',
                        backgroundColor: 'rgba(20, 184, 166, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'å¨æˆ¿æ¡ˆä¾‹': {
            title: 'ğŸ³ å¨æˆ¿æ¡ˆä¾‹è¯¦æƒ…',
            metrics: [
                { title: 'æ€»æ•°é‡', value: '5,260', change: '+32%', type: 'positive' },
                { title: 'åˆ†äº«é‡', value: '19,889', change: '-15%', type: 'negative' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'æ€»æ•°é‡',
                        data: [3981, 3982, 3982, 3982, 5260],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«é‡',
                        data: [8790, 13376, 15193, 23377, 19889],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'AIé—®ç­”': {
            title: 'ğŸ¤– AIé—®ç­”è¯¦æƒ…',
            metrics: [
                { title: 'ä½¿ç”¨äººæ•°', value: '917', change: '-32%', type: 'negative' },
                { title: 'ä½¿ç”¨äººæ¬¡', value: '2,591', change: '-27%', type: 'negative' }
            ],
            chartData: {
                labels: ['2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'ä½¿ç”¨äººæ•°',
                        data: [76, 609, 1244, 1341, 917],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'ä½¿ç”¨äººæ¬¡',
                        data: [369, 1857, 3543, 3568, 2591],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        },
        'ç”¨æˆ·æœåŠ¡å¡': {
            title: 'ğŸ¯ ç”¨æˆ·æœåŠ¡å¡è¯¦æƒ…',
            metrics: [
                { title: 'åˆ†äº«äººæ•°', value: '285', change: '0%', type: 'neutral' },
                { title: 'åˆ†äº«äººæ¬¡', value: '2,398', change: '+446%', type: 'positive' },
                { title: 'NPSäººæ•°', value: '252', change: '+196%', type: 'positive' },
                { title: 'NPSè¯„åˆ†', value: '9.888', change: '0%', type: 'neutral' }
            ],
            chartData: {
                labels: ['4æœˆ', '5æœˆ', '6æœˆ'],
                datasets: [
                    {
                        label: 'åˆ†äº«äººæ•°',
                        data: [85, 108, 285],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'åˆ†äº«äººæ¬¡',
                        data: [558, 439, 2398],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'NPSäººæ•°',
                        data: [98, 85, 252],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'NPSè¯„åˆ†',
                        data: [9.5, 9.7, 9.888],
                        borderColor: '#EC4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        tension: 0.4
                    }
                ]
            }
        }
    };

    // ä¸ºåŠŸèƒ½å¡ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶
    function addFeatureCardClickEvents() {
        const featureCards = document.querySelectorAll('.feature-card');
        featureCards.forEach(card => {
            // è·³è¿‡å ä½ç¬¦å¡ç‰‡
            if (card.hasAttribute('data-placeholder')) {
                return;
            }
            
            card.addEventListener('click', function() {
                const titleElement = this.querySelector('.feature-title');
                if (!titleElement) return;
                
                const title = titleElement.textContent.trim();
                let moduleName = '';
                
                if (title.includes('å¨æˆ¿å¥åº·æ£€æµ‹')) moduleName = 'å¨æˆ¿å¥åº·æ£€æµ‹';
                else if (title.includes('é€‰è´­æŒ‡å—')) moduleName = 'é€‰è´­æŒ‡å—';
                else if (title.includes('æœ‹å‹åœˆ')) moduleName = 'æœ‹å‹åœˆç®¡ç†';
                else if (title.includes('é—¨åº—æ´»åŠ¨')) moduleName = 'é—¨åº—æ´»åŠ¨';
                else if (title.includes('æ¬¢è¿è¯­')) moduleName = 'æ¬¢è¿è¯­';
                else if (title.includes('å¨æˆ¿æ¡ˆä¾‹')) moduleName = 'å¨æˆ¿æ¡ˆä¾‹';
                else if (title.includes('AIé—®ç­”')) moduleName = 'AIé—®ç­”';
                else if (title.includes('ç”¨æˆ·æœåŠ¡å¡')) moduleName = 'ç”¨æˆ·æœåŠ¡å¡';
                
                if (moduleName && moduleDetails[moduleName]) {
                    showModuleDetail(moduleName);
                }
            });
        });
    }

    // æ˜¾ç¤ºæ¨¡å—è¯¦æƒ…
    function showModuleDetail(moduleName) {
        const detail = moduleDetails[moduleName];
        const modal = document.getElementById('moduleDetailModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalChartsGrid = document.getElementById('modalChartsGrid');

        // è®¾ç½®æ ‡é¢˜
        modalTitle.textContent = detail.title;

        // è·å–å½“å‰çš„ç­›é€‰æ¡ä»¶
        const timeRange = document.getElementById('timeRange').value;
        const endMonth = document.getElementById('endMonth').value;
        const monthsToShow = parseInt(timeRange.replace('æœ€è¿‘', '').replace('ä¸ªæœˆ', ''));

        // ç”Ÿæˆä¸ä¸»å›¾è¡¨ä¸€è‡´çš„æ—¶é—´è½´å’Œæ•°æ®
        const { displayMonths, displayDatasets } = generateModalChartData(moduleName, endMonth, monthsToShow);

        // ç”Ÿæˆå¤šä¸ªç‹¬ç«‹å›¾è¡¨
        modalChartsGrid.innerHTML = displayDatasets.map((dataset, index) => `
            <div class="metric-chart-card">
                <div class="metric-chart-title">${dataset.label}</div>
                <div class="metric-chart-canvas">
                    <canvas id="metricChart${index}"></canvas>
                </div>
            </div>
        `).join('');

        // è®¾ç½®ç½‘æ ¼å¸ƒå±€
        const chartCount = displayDatasets.length;
        modalChartsGrid.className = `modal-charts-grid grid-${chartCount}`;

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        modal.style.display = 'flex';

        // åˆ›å»ºæ¯ä¸ªç‹¬ç«‹å›¾è¡¨
        setTimeout(() => {
            displayDatasets.forEach((dataset, index) => {
                const canvas = document.getElementById(`metricChart${index}`);
                if (canvas) {
                    createSingleMetricChart(canvas, {
                        labels: displayMonths,
                        data: dataset.data,
                        label: dataset.label,
                        borderColor: dataset.borderColor,
                        backgroundColor: dataset.backgroundColor
                    });
                }
            });
        }, 100);
    }

    // ç”Ÿæˆæ¨¡æ€æ¡†å›¾è¡¨æ•°æ®ï¼ˆä¸ä¸»å›¾è¡¨ä¸€è‡´çš„æ—¶é—´è½´é€»è¾‘ï¼‰
    function generateModalChartData(moduleName, endMonth, monthsToShow) {
        // è·å–æ¨¡å—çš„åŸå§‹æ•°æ®
        const detail = moduleDetails[moduleName];
        
        // è§£æé€‰æ‹©çš„å¹´æœˆ
        const selectedYear = parseInt(endMonth.split('-')[0]); // 2025
        const selectedMonth = parseInt(endMonth.split('-')[1]); // 2 (2æœˆ)
        
        console.log(`æ¨¡æ€æ¡†æ•°æ®ç”Ÿæˆï¼š${moduleName}, é€‰æ‹©çš„å¹´æœˆï¼š${selectedYear}å¹´${selectedMonth}æœˆ, æ˜¾ç¤º${monthsToShow}ä¸ªæœˆ`);
        
        // ç”Ÿæˆå®Œæ•´çš„æ—¶é—´è½´ï¼ˆä¸ä¸»å›¾è¡¨é€»è¾‘ä¸€è‡´ï¼‰
        const displayMonths = [];
        for (let i = 0; i < monthsToShow; i++) {
            // è®¡ç®—å½“å‰è¦æ˜¾ç¤ºçš„æœˆä»½ï¼ˆä»æœ€æ—©çš„å¼€å§‹ï¼‰
            let displayYear = selectedYear;
            let displayMonth = selectedMonth - (monthsToShow - 1 - i);
            
            // å¤„ç†æœˆä»½å°äº1çš„æƒ…å†µï¼ˆè·¨å¹´ï¼‰
            while (displayMonth <= 0) {
                displayMonth += 12;
                displayYear -= 1;
            }
            
            // ç”Ÿæˆæœˆä»½æ ‡ç­¾
            let monthLabel;
            if (displayYear === selectedYear) {
                monthLabel = `${displayMonth}æœˆ`;
            } else {
                monthLabel = `${displayMonth}æœˆ(${displayYear}å¹´)`;
            }
            
            displayMonths.push(monthLabel);
        }
        
        // ä¸ºæ¯ä¸ªæ•°æ®ç³»åˆ—ç”Ÿæˆå¯¹åº”çš„æ•°æ®
        const displayDatasets = detail.chartData.datasets.map(dataset => {
            const displayData = [];
            
            for (let i = 0; i < monthsToShow; i++) {
                // è®¡ç®—å½“å‰è¦æ˜¾ç¤ºçš„æœˆä»½
                let displayYear = selectedYear;
                let displayMonth = selectedMonth - (monthsToShow - 1 - i);
                
                // å¤„ç†æœˆä»½å°äº1çš„æƒ…å†µï¼ˆè·¨å¹´ï¼‰
                while (displayMonth <= 0) {
                    displayMonth += 12;
                    displayYear -= 1;
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®ï¼šåªæœ‰2025å¹´2-6æœˆæœ‰æ•°æ®
                let dataIndex = -1;
                if (displayYear === 2025 && displayMonth >= 2 && displayMonth <= 6) {
                    // åœ¨æˆ‘ä»¬çš„æ•°æ®èŒƒå›´å†…ï¼Œè®¡ç®—å¯¹åº”çš„æ•°ç»„ç´¢å¼•
                    dataIndex = displayMonth - 2; // 2æœˆ->0, 3æœˆ->1, 4æœˆ->2, 5æœˆ->3, 6æœˆ->4
                }
                
                // å¡«å……æ•°æ®ï¼Œæœ‰æ•°æ®çš„æœˆä»½ç”¨å®é™…æ•°æ®ï¼Œæ²¡æ•°æ®çš„ç”¨null
                if (dataIndex !== -1) {
                    displayData.push(dataset.data[dataIndex]);
                } else {
                    displayData.push(null); // Chart.jsä¼šå°†nullæ˜¾ç¤ºä¸ºç©ºç‚¹
                }
            }
            
            return {
                label: dataset.label,
                data: displayData,
                borderColor: dataset.borderColor,
                backgroundColor: dataset.backgroundColor
            };
        });
        
        console.log(`æ¨¡æ€æ¡†æ—¶é—´è½´ï¼š`, displayMonths);
        console.log(`æ¨¡æ€æ¡†æ•°æ®ç¤ºä¾‹ï¼ˆ${displayDatasets[0]?.label}ï¼‰ï¼š`, displayDatasets[0]?.data);
        
        return { displayMonths, displayDatasets };
    }

    // åˆ›å»ºè¯¦æƒ…å›¾è¡¨
    function createDetailChart(canvas, chartData) {
        // å¦‚æœå·²æœ‰å›¾è¡¨å®ä¾‹ï¼Œå…ˆé”€æ¯
        if (canvas.chartInstance) {
            canvas.chartInstance.destroy();
        }

        canvas.chartInstance = new Chart(canvas, {
            type: 'line',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            color: '#fff',
                            font: { size: 12 }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(139, 92, 246, 0.5)',
                        borderWidth: 1
                    }
                },
                scales: {
                    x: {
                        display: true,
                        ticks: { color: '#fff', font: { size: 11 } },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    y: {
                        display: true,
                        ticks: { 
                            color: '#fff', 
                            font: { size: 11 },
                            callback: function(value) {
                                if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
                                if (value >= 1000) return (value / 1000).toFixed(1) + 'K';
                                return value;
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                },
                elements: {
                    point: { radius: 4, hoverRadius: 6 },
                    line: { borderWidth: 2 }
                }
            }
        });
    }

    // åˆ›å»ºå•ä¸ªæŒ‡æ ‡å›¾è¡¨
    function createSingleMetricChart(canvas, metricData) {
        // å¦‚æœå·²æœ‰å›¾è¡¨å®ä¾‹ï¼Œå…ˆé”€æ¯
        if (canvas.chartInstance) {
            canvas.chartInstance.destroy();
        }

        canvas.chartInstance = new Chart(canvas, {
            type: 'line',
            data: {
                labels: metricData.labels,
                datasets: [{
                    label: metricData.label,
                    data: metricData.data,
                    borderColor: metricData.borderColor,
                    backgroundColor: metricData.backgroundColor,
                    tension: 0.4,
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    borderWidth: 3,
                    fill: true,
                    spanGaps: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: metricData.borderColor,
                        borderWidth: 1,
                        displayColors: false
                    }
                },
                scales: {
                    x: {
                        ticks: { 
                            color: 'rgba(255, 255, 255, 0.7)', 
                            font: { size: 11 }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    y: {
                        ticks: { 
                            color: 'rgba(255, 255, 255, 0.7)', 
                            font: { size: 11 },
                            callback: function(value) {
                                if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
                                if (value >= 1000) return (value / 1000).toFixed(1) + 'K';
                                return value;
                            }
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    }
                }
            }
        });
    }

    // å…³é—­æ¨¡æ€æ¡†
    function closeModal() {
        const modal = document.getElementById('moduleDetailModal');
        modal.style.display = 'none';
        
        // é”€æ¯æ‰€æœ‰å›¾è¡¨å®ä¾‹
        const modalChartsGrid = document.getElementById('modalChartsGrid');
        if (modalChartsGrid) {
            const canvases = modalChartsGrid.querySelectorAll('canvas');
            canvases.forEach(canvas => {
                if (canvas.chartInstance) {
                    canvas.chartInstance.destroy();
                    canvas.chartInstance = null;
                }
            });
        }
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ·»åŠ äº‹ä»¶ç›‘å¬
    setTimeout(() => {
        addFeatureCardClickEvents();
        
        // ä¸ºå…³é—­æŒ‰é’®æ·»åŠ äº‹ä»¶
        const closeButton = document.getElementById('closeModal');
        if (closeButton) {
            closeButton.addEventListener('click', closeModal);
        }
        
        // ç‚¹å‡»é®ç½©å±‚å…³é—­
        const modalOverlay = document.getElementById('moduleDetailModal');
        if (modalOverlay) {
            modalOverlay.addEventListener('click', function(e) {
                if (e.target === modalOverlay) {
                    closeModal();
                }
            });
        }
    }, 1000);
    </script>

<!-- è¯¦æƒ…å¼¹çª— -->
<div id="moduleDetailModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle" class="modal-title"></h2>
            <button id="closeModal" class="modal-close">&times;</button>
        </div>
        
        <!-- åˆ†é¡¹è¶‹åŠ¿å›¾è¡¨ -->
        <div class="detail-chart-section">
            <h3 class="detail-chart-title">å„é¡¹æŒ‡æ ‡è¶‹åŠ¿åˆ†æ</h3>
            <div id="modalChartsGrid" class="modal-charts-grid">
                <!-- åŠ¨æ€ç”Ÿæˆå¤šä¸ªå›¾è¡¨ -->
            </div>
        </div>
    </div>
</div>

</body>
</html>